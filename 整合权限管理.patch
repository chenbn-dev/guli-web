Index: admin/src/utils/auth.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/utils/auth.js	(revision 79792acc935129a65b7a3df733072f516bdb52d8)
+++ admin/src/utils/auth.js	(date 1574926016000)
@@ -1,4 +1,5 @@
 import Cookies from 'js-cookie'
+import request from './request'
 
 const TokenKey = 'Admin-Token'
 
@@ -13,3 +14,4 @@
 export function removeToken() {
   return Cookies.remove(TokenKey)
 }
+
Index: admin/src/utils/validate.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/utils/validate.js	(revision 79792acc935129a65b7a3df733072f516bdb52d8)
+++ admin/src/utils/validate.js	(date 1574926016000)
@@ -3,8 +3,9 @@
  */
 
 export function isvalidUsername(str) {
-  const valid_map = ['admin', 'editor']
-  return valid_map.indexOf(str.trim()) >= 0
+  // const valid_map = ['admin', 'editor']
+  // return valid_map.indexOf(str.trim()) >= 0
+  return str.trim() !== ''
 }
 
 /* 合法uri*/
@@ -30,3 +31,4 @@
   const reg = /^[A-Za-z]+$/
   return reg.test(str)
 }
+
Index: admin/src/utils/request.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/utils/request.js	(revision 79792acc935129a65b7a3df733072f516bdb52d8)
+++ admin/src/utils/request.js	(date 1574926016000)
@@ -1,19 +1,19 @@
 import axios from 'axios'
-import { Message, MessageBox } from 'element-ui'
+import {Message, MessageBox} from 'element-ui'
 import store from '../store'
-import { getToken } from '@/utils/auth'
+import {getToken} from '@/utils/auth'
 
 // 创建axios实例
 const service = axios.create({
   baseURL: process.env.BASE_API, // api 的 base_url
-  timeout: 5000 // 请求超时时间
+  timeout: 20000 // 请求超时时间
 })
 
 // request拦截器
 service.interceptors.request.use(
   config => {
     if (store.getters.token) {
-      config.headers['X-Token'] = getToken() // 让每个请求携带自定义token 请根据实际情况自行修改
+      config.headers['token'] = getToken() // 让每个请求携带自定义token 请根据实际情况自行修改
     }
     return config
   },
@@ -31,29 +31,13 @@
      * code为非20000是抛错 可结合自己业务进行修改
      */
     const res = response.data
+    // debugger
     if (res.code !== 20000) {
       Message({
         message: res.message,
         type: 'error',
         duration: 5 * 1000
       })
-
-      // 50008:非法的token; 50012:其他客户端登录了;  50014:Token 过期了;
-      if (res.code === 50008 || res.code === 50012 || res.code === 50014) {
-        MessageBox.confirm(
-          '你已被登出，可以取消继续留在该页面，或者重新登录',
-          '确定登出',
-          {
-            confirmButtonText: '重新登录',
-            cancelButtonText: '取消',
-            type: 'warning'
-          }
-        ).then(() => {
-          store.dispatch('FedLogOut').then(() => {
-            location.reload() // 为了重新实例化vue-router对象 避免bug
-          })
-        })
-      }
       return Promise.reject('error')
     } else {
       return response.data
Index: admin/src/store/modules/user.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/store/modules/user.js	(revision 79792acc935129a65b7a3df733072f516bdb52d8)
+++ admin/src/store/modules/user.js	(date 1576218321704)
@@ -6,6 +6,7 @@
     token: getToken(),
     name: '',
     avatar: '',
+    buttons: [],
     roles: []
   },
 
@@ -19,6 +20,9 @@
     SET_AVATAR: (state, avatar) => {
       state.avatar = avatar
     },
+    SET_BUTTONS: (state, buttons) => {
+      state.buttons = buttons
+    },
     SET_ROLES: (state, roles) => {
       state.roles = roles
     }
@@ -30,6 +34,7 @@
       const username = userInfo.username.trim()
       return new Promise((resolve, reject) => {
         login(username, userInfo.password).then(response => {
+         // debugger
           const data = response.data
           setToken(data.token)
           commit('SET_TOKEN', data.token)
@@ -39,33 +44,78 @@
         })
       })
     },
+    // Login({ commit }) {
+    //   debugger
+    //   const data = {
+    //     'token': 'helen'
+    //   }
+    //   setToken(data.token)// 将token存储在cookie中
+    //   commit('SET_TOKEN', data.token)
+    // },
 
     // 获取用户信息
-    GetInfo({ commit, state }) {
+    async GetInfo({ commit, state }) {
       return new Promise((resolve, reject) => {
         getInfo(state.token).then(response => {
+          // debugger
           const data = response.data
           if (data.roles && data.roles.length > 0) { // 验证返回的roles是否是一个非空数组
             commit('SET_ROLES', data.roles)
           } else {
             reject('getInfo: roles must be a non-null array !')
           }
+
+          const buttonAuthList = []
+          data.permissionValueList.forEach(button => {
+            buttonAuthList.push(button)
+          })
+
           commit('SET_NAME', data.name)
           commit('SET_AVATAR', data.avatar)
+          commit('SET_BUTTONS', buttonAuthList)
           resolve(response)
         }).catch(error => {
           reject(error)
         })
       })
     },
+    // GetInfo({ commit }) {
+    //   debugger
+    //   const data = {
+    //     'roles': [
+    //       'admin'
+    //     ],
+    //     'name': 'helen',
+    //     'avatar': 'https://wpimg.wallstcn.com/f778738c-e4f8-4870-b634-5670helen3b4acafe.gif'
+    //   }
+    //   if (data.roles && data.roles.length > 0) { // 验证返回的roles是否是一个非空数组
+    //     commit('SET_ROLES', data.roles)
+    //   }
+    //   commit('SET_NAME', data.name)
+    //   commit('SET_AVATAR', data.avatar)
+    // },
 
     // 登出
+    // LogOut({ commit, state }) {
+    //   return new Promise((resolve, reject) => {
+    //     logout(state.token).then(() => {
+    //       commit('SET_TOKEN', '')
+    //       commit('SET_ROLES', [])
+    //       removeToken()
+    //       resolve()
+    //     }).catch(error => {
+    //       reject(error)
+    //     })
+    //   })
+    // },
     LogOut({ commit, state }) {
       return new Promise((resolve, reject) => {
         logout(state.token).then(() => {
-          commit('SET_TOKEN', '')
-          commit('SET_ROLES', [])
-          removeToken()
+          debugger
+          commit('SET_TOKEN', '')// 清空前端vuex中存储的数据
+          commit('SET_ROLES', [])// 清空前端vuex中存储的数据
+          commit('SET_BUTTONS', [])
+          removeToken()// 清空cookie
           resolve()
         }).catch(error => {
           reject(error)
@@ -76,6 +126,7 @@
     // 前端 登出
     FedLogOut({ commit }) {
       return new Promise(resolve => {
+        debugger
         commit('SET_TOKEN', '')
         removeToken()
         resolve()
Index: admin/src/store/index.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/store/index.js	(revision 79792acc935129a65b7a3df733072f516bdb52d8)
+++ admin/src/store/index.js	(date 1574926016000)
@@ -1,17 +1,35 @@
 import Vue from 'vue'
 import Vuex from 'vuex'
-import app from './modules/app'
-import user from './modules/user'
 import getters from './getters'
+import createPersistedState from 'vuex-persistedstate'
 
 Vue.use(Vuex)
 
+const modulesFiles = require.context('./modules', false, /\.js$/)
+
+// you do not need `import app from './modules/app'`
+// it will auto require all vuex module from modules file
+const modules = modulesFiles.keys().reduce((modules, modulePath) => {
+  // set './app.js' => 'app'
+  const moduleName = modulePath.replace(/^\.\/(.*)\.\w+$/, '$1')
+  const value = modulesFiles(modulePath)
+  modules[moduleName] = value.default
+  return modules
+}, {})
+
 const store = new Vuex.Store({
-  modules: {
-    app,
-    user
-  },
-  getters
+  modules,
+  getters,
+  // 解决刷新vuex状态丢失问题
+  plugins: [createPersistedState({
+    storage: window.sessionStorage,
+    reducer(val) {
+      return {
+        // 只储存state中的assessmentData
+        dict: val.dict
+      }
+    }
+  })]
 })
 
 export default store
Index: admin/src/store/getters.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/store/getters.js	(revision 79792acc935129a65b7a3df733072f516bdb52d8)
+++ admin/src/store/getters.js	(date 1574926016000)
@@ -4,6 +4,9 @@
   token: state => state.user.token,
   avatar: state => state.user.avatar,
   name: state => state.user.name,
-  roles: state => state.user.roles
+  buttons: state => state.user.buttons,
+  roles: state => state.user.roles,
+  routes: state => state.permission.routes,
+  addRoutes: state => state.permission.addRoutes
 }
 export default getters
Index: admin/src/views/layout/components/Sidebar/index.vue.back
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/layout/components/Sidebar/index.vue.back	(date 1574926016000)
+++ admin/src/views/layout/components/Sidebar/index.vue.back	(date 1574926016000)
@@ -0,0 +1,35 @@
+<template>
+  <el-scrollbar wrap-class="scrollbar-wrapper">
+    <el-menu
+      :show-timeout="200"
+      :default-active="$route.path"
+      :collapse="isCollapse"
+      mode="vertical"
+      background-color="#304156"
+      text-color="#bfcbd9"
+      active-text-color="#409EFF"
+    >
+      <sidebar-item v-for="route in routes" :key="route.path" :item="route" :base-path="route.path"/>
+    </el-menu>
+  </el-scrollbar>
+</template>
+
+<script>
+import { mapGetters } from 'vuex'
+import SidebarItem from './SidebarItem'
+
+export default {
+  components: { SidebarItem },
+  computed: {
+    ...mapGetters([
+      'sidebar'
+    ]),
+    routes() {
+      return this.$router.options.routes
+    },
+    isCollapse() {
+      return !this.sidebar.opened
+    }
+  }
+}
+</script>
Index: admin/src/views/back/layout/components/Sidebar/Link.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/back/layout/components/Sidebar/Link.vue	(date 1594686263831)
+++ admin/src/views/back/layout/components/Sidebar/Link.vue	(date 1594686263831)
@@ -0,0 +1,39 @@
+
+<template>
+  <!-- eslint-disable vue/require-component-is-->
+  <component v-bind="linkProps(to)">
+    <slot/>
+  </component>
+</template>
+
+<script>
+import { isExternal } from '@/utils'
+
+export default {
+  props: {
+    to: {
+      type: String,
+      required: true
+    }
+  },
+  methods: {
+    isExternalLink(routePath) {
+      return isExternal(routePath)
+    },
+    linkProps(url) {
+      if (this.isExternalLink(url)) {
+        return {
+          is: 'a',
+          href: url,
+          target: '_blank',
+          rel: 'noopener'
+        }
+      }
+      return {
+        is: 'router-link',
+        to: url
+      }
+    }
+  }
+}
+</script>
Index: admin/src/views/back/layout/components/Sidebar/SidebarItem.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/back/layout/components/Sidebar/SidebarItem.vue	(date 1594686263831)
+++ admin/src/views/back/layout/components/Sidebar/SidebarItem.vue	(date 1594686263831)
@@ -0,0 +1,101 @@
+<template>
+  <div v-if="!item.hidden&&item.children" class="menu-wrapper">
+
+    <template v-if="hasOneShowingChild(item.children,item) && (!onlyOneChild.children||onlyOneChild.noShowingChildren)&&!item.alwaysShow">
+      <app-link :to="resolvePath(onlyOneChild.path)">
+        <el-menu-item :index="resolvePath(onlyOneChild.path)" :class="{'submenu-title-noDropdown':!isNest}">
+          <item v-if="onlyOneChild.meta" :icon="onlyOneChild.meta.icon||item.meta.icon" :title="onlyOneChild.meta.title" />
+        </el-menu-item>
+      </app-link>
+    </template>
+
+    <el-submenu v-else :index="resolvePath(item.path)">
+      <template slot="title">
+        <item v-if="item.meta" :icon="item.meta.icon" :title="item.meta.title" />
+      </template>
+
+      <template v-for="child in item.children" v-if="!child.hidden">
+        <sidebar-item
+          v-if="child.children&&child.children.length>0"
+          :is-nest="true"
+          :item="child"
+          :key="child.path"
+          :base-path="resolvePath(child.path)"
+          class="nest-menu" />
+        <app-link v-else :to="resolvePath(child.path)" :key="child.name">
+          <el-menu-item :index="resolvePath(child.path)">
+            <item v-if="child.meta" :icon="child.meta.icon" :title="child.meta.title" />
+          </el-menu-item>
+        </app-link>
+      </template>
+    </el-submenu>
+
+  </div>
+</template>
+
+<script>
+import path from 'path'
+import { isExternal } from '@/utils'
+import Item from './Item'
+import AppLink from './Link'
+
+export default {
+  name: 'SidebarItem',
+  components: { Item, AppLink },
+  props: {
+    // route object
+    item: {
+      type: Object,
+      required: true
+    },
+    isNest: {
+      type: Boolean,
+      default: false
+    },
+    basePath: {
+      type: String,
+      default: ''
+    }
+  },
+  data() {
+    return {
+      onlyOneChild: null
+    }
+  },
+  methods: {
+    hasOneShowingChild(children, parent) {
+      const showingChildren = children.filter(item => {
+        if (item.hidden) {
+          return false
+        } else {
+          // Temp set(will be used if only has one showing child)
+          this.onlyOneChild = item
+          return true
+        }
+      })
+
+      // When there is only one child router, the child router is displayed by default
+      if (showingChildren.length === 1) {
+        return true
+      }
+
+      // Show parent if there are no child router to display
+      if (showingChildren.length === 0) {
+        this.onlyOneChild = { ... parent, path: '', noShowingChildren: true }
+        return true
+      }
+
+      return false
+    },
+    resolvePath(routePath) {
+      if (this.isExternalLink(routePath)) {
+        return routePath
+      }
+      return path.resolve(this.basePath, routePath)
+    },
+    isExternalLink(routePath) {
+      return isExternal(routePath)
+    }
+  }
+}
+</script>
Index: admin/src/views/back/layout/components/Sidebar/index.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/back/layout/components/Sidebar/index.vue	(date 1594686263831)
+++ admin/src/views/back/layout/components/Sidebar/index.vue	(date 1594686263831)
@@ -0,0 +1,35 @@
+<template>
+  <el-scrollbar wrap-class="scrollbar-wrapper">
+    <el-menu
+      :show-timeout="200"
+      :default-active="$route.path"
+      :collapse="isCollapse"
+      mode="vertical"
+      background-color="#304156"
+      text-color="#bfcbd9"
+      active-text-color="#409EFF"
+    >
+      <sidebar-item v-for="route in routes" :key="route.path" :item="route" :base-path="route.path"/>
+    </el-menu>
+  </el-scrollbar>
+</template>
+
+<script>
+import { mapGetters } from 'vuex'
+import SidebarItem from './SidebarItem'
+
+export default {
+  components: { SidebarItem },
+  computed: {
+    ...mapGetters([
+      'sidebar'
+    ]),
+    routes() {
+      return this.$router.options.routes
+    },
+    isCollapse() {
+      return !this.sidebar.opened
+    }
+  }
+}
+</script>
Index: admin/src/views/back/layout/components/Sidebar/Item.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/back/layout/components/Sidebar/Item.vue	(date 1594686263831)
+++ admin/src/views/back/layout/components/Sidebar/Item.vue	(date 1594686263831)
@@ -0,0 +1,29 @@
+<script>
+export default {
+  name: 'MenuItem',
+  functional: true,
+  props: {
+    icon: {
+      type: String,
+      default: ''
+    },
+    title: {
+      type: String,
+      default: ''
+    }
+  },
+  render(h, context) {
+    const { icon, title } = context.props
+    const vnodes = []
+
+    if (icon) {
+      vnodes.push(<svg-icon icon-class={icon}/>)
+    }
+
+    if (title) {
+      vnodes.push(<span slot='title'>{(title)}</span>)
+    }
+    return vnodes
+  }
+}
+</script>
Index: admin/src/views/back/layout/components/Navbar.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/back/layout/components/Navbar.vue	(date 1594686263831)
+++ admin/src/views/back/layout/components/Navbar.vue	(date 1594686263831)
@@ -0,0 +1,95 @@
+<template>
+  <el-menu class="navbar" mode="horizontal">
+    <hamburger :toggle-click="toggleSideBar" :is-active="sidebar.opened" class="hamburger-container"/>
+    <breadcrumb />
+    <el-dropdown class="avatar-container" trigger="click">
+      <div class="avatar-wrapper">
+        <img :src="avatar+'?imageView2/1/w/80/h/80'" class="user-avatar">
+        <i class="el-icon-caret-bottom"/>
+      </div>
+      <el-dropdown-menu slot="dropdown" class="user-dropdown">
+        <router-link class="inlineBlock" to="/">
+          <el-dropdown-item>
+            首页
+          </el-dropdown-item>
+        </router-link>
+        <el-dropdown-item divided>
+          <span style="display:block;" @click="logout">退出</span>
+        </el-dropdown-item>
+      </el-dropdown-menu>
+    </el-dropdown>
+  </el-menu>
+</template>
+
+<script>
+import { mapGetters } from 'vuex'
+import Breadcrumb from '@/components/Breadcrumb'
+import Hamburger from '@/components/Hamburger'
+
+export default {
+  components: {
+    Breadcrumb,
+    Hamburger
+  },
+  computed: {
+    ...mapGetters([
+      'sidebar',
+      'avatar'
+    ])
+  },
+  methods: {
+    toggleSideBar() {
+      this.$store.dispatch('ToggleSideBar')
+    },
+    logout() {
+      this.$store.dispatch('LogOut').then(() => {
+        location.reload() // 为了重新实例化vue-router对象 避免bug
+      })
+    }
+  }
+}
+</script>
+
+<style rel="stylesheet/scss" lang="scss" scoped>
+.navbar {
+  height: 50px;
+  line-height: 50px;
+  border-radius: 0px !important;
+  .hamburger-container {
+    line-height: 58px;
+    height: 50px;
+    float: left;
+    padding: 0 10px;
+  }
+  .screenfull {
+    position: absolute;
+    right: 90px;
+    top: 16px;
+    color: red;
+  }
+  .avatar-container {
+    height: 50px;
+    display: inline-block;
+    position: absolute;
+    right: 35px;
+    .avatar-wrapper {
+      cursor: pointer;
+      margin-top: 5px;
+      position: relative;
+      line-height: initial;
+      .user-avatar {
+        width: 40px;
+        height: 40px;
+        border-radius: 10px;
+      }
+      .el-icon-caret-bottom {
+        position: absolute;
+        right: -20px;
+        top: 25px;
+        font-size: 12px;
+      }
+    }
+  }
+}
+</style>
+
Index: admin/src/views/back/layout/components/AppMain.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/back/layout/components/AppMain.vue	(date 1594686263831)
+++ admin/src/views/back/layout/components/AppMain.vue	(date 1594686263831)
@@ -0,0 +1,29 @@
+<template>
+  <section class="app-main">
+    <transition name="fade-transform" mode="out-in">
+      <!-- or name="fade" -->
+      <!-- <router-view :key="key"></router-view> -->
+      <router-view/>
+    </transition>
+  </section>
+</template>
+
+<script>
+export default {
+  name: 'AppMain',
+  computed: {
+    // key() {
+    //   return this.$route.name !== undefined ? this.$route.name + +new Date() : this.$route + +new Date()
+    // }
+  }
+}
+</script>
+
+<style scoped>
+.app-main {
+  /*50 = navbar  */
+  min-height: calc(100vh - 50px);
+  position: relative;
+  overflow: hidden;
+}
+</style>
Index: admin/src/views/back/layout/components/index.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/back/layout/components/index.js	(date 1594686263831)
+++ admin/src/views/back/layout/components/index.js	(date 1594686263831)
@@ -0,0 +1,3 @@
+export { default as Navbar } from './Navbar'
+export { default as Sidebar } from './Sidebar'
+export { default as AppMain } from './AppMain'
Index: admin/src/views/back/dashboard/index.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/back/dashboard/index.vue	(date 1594686263821)
+++ admin/src/views/back/dashboard/index.vue	(date 1594686263821)
@@ -0,0 +1,32 @@
+<template>
+  <div class="dashboard-container">
+    <div class="dashboard-text">name:{{ name }}</div>
+    <div class="dashboard-text">roles:<span v-for="role in roles" :key="role">{{ role }}</span></div>
+  </div>
+</template>
+
+<script>
+import { mapGetters } from 'vuex'
+
+export default {
+  name: 'Dashboard',
+  computed: {
+    ...mapGetters([
+      'name',
+      'roles'
+    ])
+  }
+}
+</script>
+
+<style rel="stylesheet/scss" lang="scss" scoped>
+.dashboard {
+  &-container {
+    margin: 30px;
+  }
+  &-text {
+    font-size: 30px;
+    line-height: 46px;
+  }
+}
+</style>
Index: admin/src/views/back/layout/mixin/ResizeHandler.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/back/layout/mixin/ResizeHandler.js	(date 1594686263831)
+++ admin/src/views/back/layout/mixin/ResizeHandler.js	(date 1594686263831)
@@ -0,0 +1,41 @@
+import store from '@/store'
+
+const { body } = document
+const WIDTH = 1024
+const RATIO = 3
+
+export default {
+  watch: {
+    $route(route) {
+      if (this.device === 'mobile' && this.sidebar.opened) {
+        store.dispatch('CloseSideBar', { withoutAnimation: false })
+      }
+    }
+  },
+  beforeMount() {
+    window.addEventListener('resize', this.resizeHandler)
+  },
+  mounted() {
+    const isMobile = this.isMobile()
+    if (isMobile) {
+      store.dispatch('ToggleDevice', 'mobile')
+      store.dispatch('CloseSideBar', { withoutAnimation: true })
+    }
+  },
+  methods: {
+    isMobile() {
+      const rect = body.getBoundingClientRect()
+      return rect.width - RATIO < WIDTH
+    },
+    resizeHandler() {
+      if (!document.hidden) {
+        const isMobile = this.isMobile()
+        store.dispatch('ToggleDevice', isMobile ? 'mobile' : 'desktop')
+
+        if (isMobile) {
+          store.dispatch('CloseSideBar', { withoutAnimation: true })
+        }
+      }
+    }
+  }
+}
Index: admin/src/views/back/layout/Layout.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/back/layout/Layout.vue	(date 1594686263831)
+++ admin/src/views/back/layout/Layout.vue	(date 1594686263831)
@@ -0,0 +1,69 @@
+<template>
+  <div :class="classObj" class="app-wrapper">
+    <div v-if="device==='mobile'&&sidebar.opened" class="drawer-bg" @click="handleClickOutside"/>
+    <sidebar class="sidebar-container"/>
+    <div class="main-container">
+      <navbar/>
+      <app-main/>
+    </div>
+  </div>
+</template>
+
+<script>
+import { Navbar, Sidebar, AppMain } from './components'
+import ResizeMixin from './mixin/ResizeHandler'
+
+export default {
+  name: 'Layout',
+  components: { //
+    Navbar,
+    Sidebar,
+    AppMain
+  },
+  mixins: [ResizeMixin],
+  computed: {
+    sidebar() {
+      return this.$store.state.app.sidebar
+    },
+    device() {
+      return this.$store.state.app.device
+    },
+    classObj() {
+      return {
+        hideSidebar: !this.sidebar.opened,
+        openSidebar: this.sidebar.opened,
+        withoutAnimation: this.sidebar.withoutAnimation,
+        mobile: this.device === 'mobile'
+      }
+    }
+  },
+  methods: {
+    handleClickOutside() {
+      this.$store.dispatch('CloseSideBar', { withoutAnimation: false })
+    }
+  }
+}
+</script>
+
+<style rel="stylesheet/scss" lang="scss" scoped>
+  @import "src/styles/mixin.scss";
+  .app-wrapper {
+    @include clearfix;
+    position: relative;
+    height: 100%;
+    width: 100%;
+    &.mobile.openSidebar{
+      position: fixed;
+      top: 0;
+    }
+  }
+  .drawer-bg {
+    background: #000;
+    opacity: 0.3;
+    width: 100%;
+    top: 0;
+    height: 100%;
+    position: absolute;
+    z-index: 999;
+  }
+</style>
Index: admin/src/views/back/login/index.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/back/login/index.vue	(date 1594686263831)
+++ admin/src/views/back/login/index.vue	(date 1594686263831)
@@ -0,0 +1,196 @@
+<template>
+  <div class="login-container">
+    <el-form ref="loginForm" :model="loginForm" :rules="loginRules" class="login-form" auto-complete="on" label-position="left">
+      <h3 class="title">格桑学院后台管理系统</h3>
+      <el-form-item prop="username">
+        <span class="svg-container">
+          <svg-icon icon-class="user" />
+        </span>
+        <el-input v-model="loginForm.username" name="username" type="text" auto-complete="on" placeholder="username" />
+      </el-form-item>
+      <el-form-item prop="password">
+        <span class="svg-container">
+          <svg-icon icon-class="password" />
+        </span>
+        <el-input
+          :type="pwdType"
+          v-model="loginForm.password"
+          name="password"
+          auto-complete="on"
+          placeholder="password"
+          @keyup.enter.native="handleLogin" />
+        <span class="show-pwd" @click="showPwd">
+          <svg-icon icon-class="eye" />
+        </span>
+      </el-form-item>
+      <el-form-item>
+        <el-button :loading="loading" type="primary" style="width:100%;" @click.native.prevent="handleLogin">
+          登录
+        </el-button>
+      </el-form-item>
+      <div class="tips">
+        <span style="margin-right:20px;">username: admin</span>
+        <span> password: admin</span>
+      </div>
+    </el-form>
+  </div>
+</template>
+
+<script>
+import { isvalidUsername } from '@/utils/validate'
+
+export default {
+  name: 'Login',
+  data() {
+    const validateUsername = (rule, value, callback) => {
+      if (!isvalidUsername(value)) {
+        callback(new Error('请输入正确的用户名'))
+      } else {
+        callback()
+      }
+    }
+    const validatePass = (rule, value, callback) => {
+      if (value.length < 5) {
+        callback(new Error('密码不能小于5位'))
+      } else {
+        callback()
+      }
+    }
+    return {
+      loginForm: {
+        username: 'admin',
+        password: 'admin'
+      },
+      loginRules: {
+        username: [{ required: true, trigger: 'blur', validator: validateUsername }],
+        password: [{ required: true, trigger: 'blur', validator: validatePass }]
+      },
+      loading: false,
+      pwdType: 'password',
+      redirect: undefined
+    }
+  },
+  watch: {
+    $route: {
+      handler: function(route) {
+        this.redirect = route.query && route.query.redirect
+      },
+      immediate: true
+    }
+  },
+  methods: {
+    showPwd() {
+      if (this.pwdType === 'password') {
+        this.pwdType = ''
+      } else {
+        this.pwdType = 'password'
+      }
+    },
+    handleLogin() {
+      this.$refs.loginForm.validate(valid => {
+        if (valid) {
+          this.loading = true
+          this.$store.dispatch('Login', this.loginForm).then(() => {
+            this.loading = false
+            this.$router.push({ path: this.redirect || '/' })
+          }).catch(() => {
+            this.loading = false
+          })
+        } else {
+          console.log('error submit!!')
+          return false
+        }
+      })
+    }
+  }
+}
+</script>
+
+<style rel="stylesheet/scss" lang="scss">
+$bg:#2d3a4b;
+$light_gray:#eee;
+
+/* reset element-ui css */
+.login-container {
+  .el-input {
+    display: inline-block;
+    height: 47px;
+    width: 85%;
+    input {
+      background: transparent;
+      border: 0px;
+      -webkit-appearance: none;
+      border-radius: 0px;
+      padding: 12px 5px 12px 15px;
+      color: $light_gray;
+      height: 47px;
+      &:-webkit-autofill {
+        -webkit-box-shadow: 0 0 0px 1000px $bg inset !important;
+        -webkit-text-fill-color: #fff !important;
+      }
+    }
+  }
+  .el-form-item {
+    border: 1px solid rgba(255, 255, 255, 0.1);
+    background: rgba(0, 0, 0, 0.1);
+    border-radius: 5px;
+    color: #454545;
+  }
+}
+
+</style>
+
+<style rel="stylesheet/scss" lang="scss" scoped>
+$bg:#2d3a4b;
+$dark_gray:#889aa4;
+$light_gray:#eee;
+.login-container {
+  position: fixed;
+  height: 100%;
+  width: 100%;
+  background-color: $bg;
+  .login-form {
+    position: absolute;
+    left: 0;
+    right: 0;
+    width: 520px;
+    max-width: 100%;
+    padding: 35px 35px 15px 35px;
+    margin: 120px auto;
+  }
+  .tips {
+    font-size: 14px;
+    color: #fff;
+    margin-bottom: 10px;
+    span {
+      &:first-of-type {
+        margin-right: 16px;
+      }
+    }
+  }
+  .svg-container {
+    padding: 6px 5px 6px 15px;
+    color: $dark_gray;
+    vertical-align: middle;
+    width: 30px;
+    display: inline-block;
+  }
+  .title {
+    font-size: 26px;
+    font-weight: 400;
+    color: $light_gray;
+    margin: 0px auto 40px auto;
+    text-align: center;
+    font-weight: bold;
+  }
+  .show-pwd {
+    position: absolute;
+    right: 10px;
+    top: 7px;
+    font-size: 16px;
+    color: $dark_gray;
+    cursor: pointer;
+    user-select: none;
+  }
+}
+</style>
Index: admin/config/dev.env.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/config/dev.env.js	(revision 79792acc935129a65b7a3df733072f516bdb52d8)
+++ admin/config/dev.env.js	(date 1596204171658)
@@ -5,6 +5,6 @@
 module.exports = merge(prodEnv, {
   NODE_ENV: '"development"',
   // BASE_API: '"https://easy-mock.com/mock/5950a2419adc231f356a6636/vue-admin"',
-  BASE_API: '"http://localhost:8001"'
-  // BASE_API: '"http://localhost:9001"'
+  // BASE_API: '"http://localhost:8001"'
+  BASE_API: '"http://localhost:8222"'
 })
Index: admin/src/store/index-bak.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/store/index-bak.js	(date 1594686263821)
+++ admin/src/store/index-bak.js	(date 1594686263821)
@@ -0,0 +1,17 @@
+import Vue from 'vue'
+import Vuex from 'vuex'
+import app from './modules/app'
+import user from './modules/user'
+import getters from './getters'
+
+Vue.use(Vuex)
+
+const store = new Vuex.Store({
+  modules: {
+    app,
+    user
+  },
+  getters
+})
+
+export default store
Index: admin/src/store/getters-bak.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/store/getters-bak.js	(date 1594686263811)
+++ admin/src/store/getters-bak.js	(date 1594686263811)
@@ -0,0 +1,9 @@
+const getters = {
+  sidebar: state => state.app.sidebar,
+  device: state => state.app.device,
+  token: state => state.user.token,
+  avatar: state => state.user.avatar,
+  name: state => state.user.name,
+  roles: state => state.user.roles
+}
+export default getters
Index: admin/src/utils/bak/request.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/utils/bak/request.js	(date 1594686263821)
+++ admin/src/utils/bak/request.js	(date 1594686263821)
@@ -0,0 +1,73 @@
+import axios from 'axios'
+import { Message, MessageBox } from 'element-ui'
+import store from '../store'
+import { getToken } from '@/utils/auth'
+
+// 创建axios实例
+const service = axios.create({
+  baseURL: process.env.BASE_API, // api 的 base_url
+  timeout: 5000 // 请求超时时间
+})
+
+// request拦截器
+service.interceptors.request.use(
+  config => {
+    if (store.getters.token) {
+      config.headers['X-Token'] = getToken() // 让每个请求携带自定义token 请根据实际情况自行修改
+    }
+    return config
+  },
+  error => {
+    // Do something with request error
+    console.log(error) // for debug
+    Promise.reject(error)
+  }
+)
+
+// response 拦截器
+service.interceptors.response.use(
+  response => {
+    /**
+     * code为非20000是抛错 可结合自己业务进行修改
+     */
+    const res = response.data
+    if (res.code !== 20000) {
+      Message({
+        message: res.message,
+        type: 'error',
+        duration: 5 * 1000
+      })
+
+      // 50008:非法的token; 50012:其他客户端登录了;  50014:Token 过期了;
+      if (res.code === 50008 || res.code === 50012 || res.code === 50014) {
+        MessageBox.confirm(
+          '你已被登出，可以取消继续留在该页面，或者重新登录',
+          '确定登出',
+          {
+            confirmButtonText: '重新登录',
+            cancelButtonText: '取消',
+            type: 'warning'
+          }
+        ).then(() => {
+          store.dispatch('FedLogOut').then(() => {
+            location.reload() // 为了重新实例化vue-router对象 避免bug
+          })
+        })
+      }
+      return Promise.reject('error')
+    } else {
+      return response.data
+    }
+  },
+  error => {
+    console.log('err' + error) // for debug
+    Message({
+      message: error.message,
+      type: 'error',
+      duration: 5 * 1000
+    })
+    return Promise.reject(error)
+  }
+)
+
+export default service
Index: admin/src/utils/bak/validate.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/utils/bak/validate.js	(date 1594686263821)
+++ admin/src/utils/bak/validate.js	(date 1594686263821)
@@ -0,0 +1,32 @@
+/**
+ * Created by jiachenpan on 16/11/18.
+ */
+
+export function isvalidUsername(str) {
+  const valid_map = ['admin', 'editor']
+  return valid_map.indexOf(str.trim()) >= 0
+}
+
+/* 合法uri*/
+export function validateURL(textval) {
+  const urlregex = /^(https?|ftp):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/
+  return urlregex.test(textval)
+}
+
+/* 小写字母*/
+export function validateLowerCase(str) {
+  const reg = /^[a-z]+$/
+  return reg.test(str)
+}
+
+/* 大写字母*/
+export function validateUpperCase(str) {
+  const reg = /^[A-Z]+$/
+  return reg.test(str)
+}
+
+/* 大小写字母*/
+export function validatAlphabets(str) {
+  const reg = /^[A-Za-z]+$/
+  return reg.test(str)
+}
Index: admin/src/utils/bak/index.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/utils/bak/index.js	(date 1594686263821)
+++ admin/src/utils/bak/index.js	(date 1594686263821)
@@ -0,0 +1,74 @@
+/**
+ * Created by jiachenpan on 16/11/18.
+ */
+
+export function parseTime(time, cFormat) {
+  if (arguments.length === 0) {
+    return null
+  }
+  const format = cFormat || '{y}-{m}-{d} {h}:{i}:{s}'
+  let date
+  if (typeof time === 'object') {
+    date = time
+  } else {
+    if (('' + time).length === 10) time = parseInt(time) * 1000
+    date = new Date(time)
+  }
+  const formatObj = {
+    y: date.getFullYear(),
+    m: date.getMonth() + 1,
+    d: date.getDate(),
+    h: date.getHours(),
+    i: date.getMinutes(),
+    s: date.getSeconds(),
+    a: date.getDay()
+  }
+  const time_str = format.replace(/{(y|m|d|h|i|s|a)+}/g, (result, key) => {
+    let value = formatObj[key]
+    // Note: getDay() returns 0 on Sunday
+    if (key === 'a') { return ['日', '一', '二', '三', '四', '五', '六'][value ] }
+    if (result.length > 0 && value < 10) {
+      value = '0' + value
+    }
+    return value || 0
+  })
+  return time_str
+}
+
+export function formatTime(time, option) {
+  time = +time * 1000
+  const d = new Date(time)
+  const now = Date.now()
+
+  const diff = (now - d) / 1000
+
+  if (diff < 30) {
+    return '刚刚'
+  } else if (diff < 3600) {
+    // less 1 hour
+    return Math.ceil(diff / 60) + '分钟前'
+  } else if (diff < 3600 * 24) {
+    return Math.ceil(diff / 3600) + '小时前'
+  } else if (diff < 3600 * 24 * 2) {
+    return '1天前'
+  }
+  if (option) {
+    return parseTime(time, option)
+  } else {
+    return (
+      d.getMonth() +
+      1 +
+      '月' +
+      d.getDate() +
+      '日' +
+      d.getHours() +
+      '时' +
+      d.getMinutes() +
+      '分'
+    )
+  }
+}
+
+export function isExternal(path) {
+  return /^(https?:|mailto:|tel:)/.test(path)
+}
Index: admin/src/utils/bak/permission.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/utils/bak/permission.js	(date 1574926016000)
+++ admin/src/utils/bak/permission.js	(date 1574926016000)
@@ -0,0 +1,31 @@
+import store from '@/store'
+
+/**
+ * @param {Array} value
+ * @returns {Boolean}
+ * @example see @/views/permission/directive.vue
+ */
+export default function checkPermission(value) {
+  if (value && value instanceof Array && value.length > 0) {
+    const roles = store.getters && store.getters.roles
+    const permissionRoles = value
+
+    const hasPermission = roles.some(role => {
+      return permissionRoles.includes(role)
+    })
+
+    if (!hasPermission) {
+      return false
+    }
+    return true
+  } else {
+    console.error(`need roles! Like v-permission="['admin','editor']"`)
+    return false
+  }
+}
+
+// 用来控制按钮的显示
+export function hasBtnPermission(permission) {
+  const myBtns = store.getters.buttons
+  return myBtns.indexOf(permission) > -1
+}
Index: admin/src/utils/permission.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/utils/permission.js	(date 1574926016000)
+++ admin/src/utils/permission.js	(date 1574926016000)
@@ -0,0 +1,31 @@
+import store from '@/store'
+
+/**
+ * @param {Array} value
+ * @returns {Boolean}
+ * @example see @/views/permission/directive.vue
+ */
+export default function checkPermission(value) {
+  if (value && value instanceof Array && value.length > 0) {
+    const roles = store.getters && store.getters.roles
+    const permissionRoles = value
+
+    const hasPermission = roles.some(role => {
+      return permissionRoles.includes(role)
+    })
+
+    if (!hasPermission) {
+      return false
+    }
+    return true
+  } else {
+    console.error(`need roles! Like v-permission="['admin','editor']"`)
+    return false
+  }
+}
+
+// 用来控制按钮的显示
+export function hasBtnPermission(permission) {
+  const myBtns = store.getters.buttons
+  return myBtns.indexOf(permission) > -1
+}
Index: admin/src/utils/bak/auth.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/utils/bak/auth.js	(date 1594686263821)
+++ admin/src/utils/bak/auth.js	(date 1594686263821)
@@ -0,0 +1,15 @@
+import Cookies from 'js-cookie'
+
+const TokenKey = 'Admin-Token'
+
+export function getToken() {
+  return Cookies.get(TokenKey)
+}
+
+export function setToken(token) {
+  return Cookies.set(TokenKey, token)
+}
+
+export function removeToken() {
+  return Cookies.remove(TokenKey)
+}
Index: admin/src/views/acl/user/roleForm.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/acl/user/roleForm.vue	(date 1574926016000)
+++ admin/src/views/acl/user/roleForm.vue	(date 1574926016000)
@@ -0,0 +1,89 @@
+<template>
+  <div class="app-container">
+    <el-checkbox :indeterminate="isIndeterminate" v-model="checkAll" @change="handleCheckAllChange">全选</el-checkbox>
+    <div style="margin: 15px 0;"></div>
+    <el-checkbox-group v-model="checkedCities" @change="handleCheckedCitiesChange">
+        <el-checkbox v-for="city in cities" :label="city.id" :key="city.id">{{city.roleName}}</el-checkbox>
+    </el-checkbox-group>
+    </br>
+    <el-button :disabled="saveBtnDisabled" type="primary" @click="update">保存</el-button>
+    
+  </div>
+</template>
+
+<script>
+
+import userApi from '@/api/acl/user'
+
+//const cityOptions = ['上海', '北京', '广州', '深圳'];
+
+export default {
+  data() {
+      return {
+        checkAll: false,
+        checkedCities: [], //已选中
+        cities: [], //所有的
+        isIndeterminate: true,
+        userId:'',
+        saveBtnDisabled: false // 保存按钮是否禁用,
+      };
+    },
+    created () {
+      this.init()  
+    },
+    methods: {
+      init(){
+          if (this.$route.params && this.$route.params.id) {
+                this.userId = this.$route.params.id
+                this.getById(this.userId)
+            } 
+      },
+      getById(userId){
+          userApi.getAssign(userId).then(response => {
+              var jsonObj = response.data.assignRoles
+              this.checkedCities = this.getJsonToList(jsonObj,"id")
+              this.cities = response.data.allRolesList
+          })
+      },
+      //把json数据转成string再转成对象，根据Key获取value数据
+      getJsonToList(json,key){
+        
+          //把JSON字符串转成对象
+          var list = JSON.parse(JSON.stringify(json));
+          //var list = JSON.parse(json)
+          var strText = []
+          //遍历这个集合对象，获取key的值
+          for(var i = 0; i < list.length; i++){
+             strText.push(list[i][key])
+          }
+          return strText;
+        
+      },
+      handleCheckAllChange(val) {
+        this.checkedCities = val ? this.cities : [];
+        this.isIndeterminate = false;
+      },
+      handleCheckedCitiesChange(value) {
+      
+        let checkedCount = value.length;
+        this.checkAll = checkedCount === this.cities.length;
+        this.isIndeterminate = checkedCount > 0 && checkedCount < this.cities.length;
+      },
+      update(){
+        this.saveBtnDisabled = true // 防止表单重复提交
+        var ids = this.checkedCities.join(",")
+        console.log(ids)
+        //修改权限
+        userApi.saveAssign(this.userId, ids).then(response => {
+            if(response.success){
+              this.$message({
+                type:'success',
+                message:'保存成功'
+              })
+              this.$router.push({ path: '/acl/user/list' })
+            }
+        })
+      }
+    }
+};
+</script>
Index: admin/src/views/acl/user/form.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/acl/user/form.vue	(date 1574926016000)
+++ admin/src/views/acl/user/form.vue	(date 1574926016000)
@@ -0,0 +1,134 @@
+<template>
+  <div class="app-container">
+    <el-form ref="user" :model="user" :rules="validateRules" label-width="120px">
+      <el-form-item label="用户名" prop="username">
+        <el-input v-model="user.username"/>
+      </el-form-item>
+      <el-form-item label="用户昵称">
+        <el-input v-model="user.nickName"/>
+      </el-form-item>
+     
+      <el-form-item v-if="!user.id" label="用户密码" prop="password">
+        <el-input v-model="user.password"/>
+      </el-form-item>
+
+
+      <el-form-item>
+        <el-button :disabled="saveBtnDisabled" type="primary" @click="saveOrUpdate">保存</el-button>
+      </el-form-item>
+    </el-form>
+  </div>
+</template>
+
+<script>
+
+import userApi from '@/api/acl/user'
+
+const defaultForm = {
+  username: '',
+  nickName: '',
+  password: ''
+}
+
+const validatePass = (rule, value, callback) => {
+  if (value.length < 6) {
+    callback(new Error('密码不能小于6位'))
+  } else {
+    callback()
+  }
+}
+
+export default {
+  data() {
+    return {
+      user: defaultForm,
+      saveBtnDisabled: false, // 保存按钮是否禁用,
+      validateRules: {
+        username: [{ required: true, trigger: 'blur', message: '用户名必须输入' }],
+        password: [{ required: true, trigger: 'blur', validator: validatePass }]
+      }
+    }
+  },
+
+  // 监听器
+  watch: {
+    $route(to, from) {
+      console.log('路由变化......')
+      console.log(to)
+      console.log(from)
+      this.init()
+    }
+  },
+
+  // 生命周期方法（在路由切换，组件不变的情况下不会被调用）
+  created() {
+    console.log('form created ......')
+    this.init()
+  },
+
+  methods: {
+
+    // 表单初始化
+    init() {
+      debugger
+      if (this.$route.params && this.$route.params.id) {
+        const id = this.$route.params.id
+        this.fetchDataById(id)
+      } else {
+        // 对象拓展运算符：拷贝对象，而不是赋值对象的引用
+        this.user = { ...defaultForm }
+      }
+    },
+
+    saveOrUpdate() {
+      this.$refs.user.validate(valid => {
+        if (valid) {
+          this.saveBtnDisabled = true // 防止表单重复提交
+          if (!this.user.id) {
+            this.saveData()
+          } else {
+            this.updateData()
+          }
+        }
+      })
+    },
+
+    // 新增讲师
+    saveData() {
+      userApi.save(this.user).then(response => {
+        // debugger
+        if (response.success) {
+          this.$message({
+            type: 'success',
+            message: response.message
+          })
+          this.$router.push({ path: '/acl/user/list' })
+        }
+      })
+    },
+
+    // 根据id更新记录
+    updateData() {
+      // teacher数据的获取
+      userApi.updateById(this.user).then(response => {
+        if (response.success) {
+          this.$message({
+            type: 'success',
+            message: response.message
+          })
+          this.$router.push({ path: '/acl/user/list' })
+        }
+      })
+    },
+
+    // 根据id查询记录
+    fetchDataById(id) {
+      userApi.getById(id).then(response => {
+        debugger
+        this.user = response.data.item
+      })
+    }
+
+  }
+}
+</script>
Index: admin/src/views/acl/user/list.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/acl/user/list.vue	(date 1574926016000)
+++ admin/src/views/acl/user/list.vue	(date 1574926016000)
@@ -0,0 +1,230 @@
+<template>
+  <div class="app-container">
+    <!-- 查询表单 -->
+    <!--查询表单-->
+    <el-form :inline="true" class="demo-form-inline">
+      <el-form-item>
+         <el-input v-model="searchObj.username" placeholder="用户名"/>
+      </el-form-item>
+
+      <el-button type="primary" icon="el-icon-search" @click="fetchData()">查询</el-button>
+      <el-button type="default" @click="resetData()">清空</el-button>
+    </el-form>
+
+    <!-- 工具条 -->
+    <div>
+      <el-button type="danger" size="mini" @click="addUser()" v-if="hasPerm('user.add')">添加</el-button>
+      <el-button type="danger" size="mini" @click="removeRows()" v-if="hasPerm('user.remove')">批量删除</el-button>
+
+    </div>
+
+    <!-- 讲师列表 -->
+    <el-table
+      v-loading="listLoading"
+      :data="list"
+      stripe
+      style="width: 100%"
+      @selection-change="handleSelectionChange">
+
+      <el-table-column
+        type="selection"
+        width="55" />
+
+      <el-table-column
+        label="序号"
+        width="70"
+        align="center">
+        <template slot-scope="scope">
+          {{ (page - 1) * limit + scope.$index + 1 }}
+        </template>
+      </el-table-column>
+
+      <el-table-column prop="username" label="用户名" width="150" />
+
+      <el-table-column prop="nickName" label="用户昵称" />
+
+      <el-table-column prop="gmtCreate" label="创建时间" width="180"/>
+
+      <el-table-column label="操作" width="230" align="center">
+        <template slot-scope="scope">
+          <router-link :to="'/acl/user/role/'+scope.row.id">
+            <el-button type="info" size="mini" icon="el-icon-info" v-if="hasPerm('user.assgin')"></el-button>
+          </router-link>
+          <router-link :to="'/acl/user/update/'+scope.row.id">
+            <el-button type="primary" size="mini" icon="el-icon-edit" v-if="hasPerm('user.update')"></el-button>
+          </router-link>
+          <el-button type="danger" size="mini" icon="el-icon-delete" @click="removeDataById(scope.row.id)" v-if="hasPerm('user.remove')"></el-button>
+        </template>
+      </el-table-column>
+    </el-table>
+
+    <!-- 分页组件 -->
+    <el-pagination
+      :current-page="page"
+      :total="total"
+      :page-size="limit"
+      :page-sizes="[5, 10, 20, 30, 40, 50, 100]"
+      style="padding: 30px 0; text-align: center;"
+      layout="sizes, prev, pager, next, jumper, ->, total, slot"
+      @current-change="fetchData"
+      @size-change="changeSize"
+    />
+  </div>
+</template>
+
+<script>
+import user from '@/api/acl/user'
+
+export default {
+  data() {
+    return {
+      listLoading: true, // 数据是否正在加载
+      list: null, // 讲师列表
+      total: 0, // 数据库中的总记录数
+      page: 1, // 默认页码
+      limit: 10, // 每页记录数
+      searchObj: {}, // 查询表单对象
+      multipleSelection: [] // 批量选择中选择的记录列表
+    }
+  },
+
+  // 生命周期函数：内存准备完毕，页面尚未渲染
+  created() {
+    console.log('list created......')
+    this.fetchData()
+  },
+
+  // 生命周期函数：内存准备完毕，页面渲染成功
+  mounted() {
+    console.log('list mounted......')
+  },
+
+  methods: {
+
+    // 当页码发生改变的时候
+    changeSize(size) {
+      console.log(size)
+      this.limit = size
+      this.fetchData(1)
+    },
+
+    addUser(){
+      this.$router.push({ path: '/acl/user/add' })
+    },
+
+    // 加载讲师列表数据
+    fetchData(page = 1) {
+      console.log('翻页。。。' + page)
+      // 异步获取远程数据（ajax）
+      this.page = page
+
+      user.getPageList(this.page, this.limit, this.searchObj).then(
+        response => {
+          this.list = response.data.items
+          this.total = response.data.total
+
+          // 数据加载并绑定成功
+          this.listLoading = false
+        }
+      )
+    },
+
+    // 重置查询表单
+    resetData() {
+      console.log('重置查询表单')
+      this.searchObj = {}
+      this.fetchData()
+    },
+
+    // 根据id删除数据
+    removeDataById(id) {
+      // debugger
+      this.$confirm('此操作将永久删除该记录, 是否继续?', '提示', {
+        confirmButtonText: '确定',
+        cancelButtonText: '取消',
+        type: 'warning'
+      }).then(() => { // promise
+        // 点击确定，远程调用ajax
+        return user.removeById(id)
+      }).then((response) => {
+        this.fetchData(this.page)
+        if (response.success) {
+          this.$message({
+            type: 'success',
+            message: '删除成功!'
+          })
+        }
+      }).catch(() => {
+        this.$message({
+          type: 'info',
+          message: '已取消删除'
+        })
+      })
+    },
+
+    // 当表格复选框选项发生变化的时候触发
+    handleSelectionChange(selection) {
+      console.log('handleSelectionChange......')
+      console.log(selection)
+      this.multipleSelection = selection
+    },
+
+    // 批量删除
+    removeRows() {
+      console.log('removeRows......')
+
+      if (this.multipleSelection.length === 0) {
+        this.$message({
+          type: 'warning',
+          message: '请选择要删除的记录!'
+        })
+        return
+      }
+
+      this.$confirm('此操作将永久删除该记录, 是否继续?', '提示', {
+        confirmButtonText: '确定',
+        cancelButtonText: '取消',
+        type: 'warning'
+      }).then(() => { // promise
+        // 点击确定，远程调用ajax
+        // 遍历selection，将id取出放入id列表
+        var idList = []
+        this.multipleSelection.forEach(item => {
+          idList.push(item.id)
+        // console.log(idList)
+        })
+        // 调用api
+        return user.removeRows(idList)
+      }).then((response) => {
+        this.fetchData(this.page)
+        if (response.success) {
+          this.$message({
+            type: 'success',
+            message: '删除成功!'
+          })
+        }
+      }).catch(() => {
+        this.$message({
+          type: 'info',
+          message: '已取消删除'
+        })
+      })
+    },
+
+    // 执行搜索
+    // queryString：文本框中输入的值
+    // cb：一个函数
+    querySearch(queryString, cb) {
+      console.log(queryString)
+      console.log(cb)
+
+      // teacher.selectNameByKey(queryString).then(response => {
+      //   // 调用 callback 返回建议列表的数据
+      //   cb(response.data.items)
+      // })
+    }
+  }
+}
+</script>
+
+
Index: admin/src/views/acl/role/list.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/acl/role/list.vue	(date 1574926016000)
+++ admin/src/views/acl/role/list.vue	(date 1574926016000)
@@ -0,0 +1,226 @@
+<template>
+  <div class="app-container">
+    <!-- 查询表单 -->
+    <!--查询表单-->
+    <el-form :inline="true" class="demo-form-inline">
+      <el-form-item>
+        <el-input v-model="searchObj.roleName" placeholder="角色名称"/>
+      </el-form-item>
+
+      <el-button type="primary" icon="el-icon-search" @click="fetchData()">查询</el-button>
+      <el-button type="default" @click="resetData()">清空</el-button>
+    </el-form>
+
+    <!-- 工具条 -->
+    <div>
+      <el-button type="danger" size="mini" @click="addUser()" v-if="hasPerm('role.add')">添加</el-button>
+      <el-button type="danger" size="mini" @click="removeRows()" v-if="hasPerm('role.remove')">批量删除</el-button>
+
+    </div>
+
+    <!-- 讲师列表 -->
+    <el-table
+      v-loading="listLoading"
+      :data="list"
+      stripe
+      style="width: 100%"
+      @selection-change="handleSelectionChange">
+
+      <el-table-column
+        type="selection"
+        width="55" />
+
+      <el-table-column
+        label="序号"
+        width="70"
+        align="center">
+        <template slot-scope="scope">
+          {{ (page - 1) * limit + scope.$index + 1 }}
+        </template>
+      </el-table-column>
+
+      <el-table-column prop="roleName" label="角色名称" />
+
+
+      <el-table-column label="操作" width="200" align="center">
+        <template slot-scope="scope">
+          <router-link :to="'/acl/role/distribution/'+scope.row.id">
+            <el-button type="info" size="mini" icon="el-icon-info" v-if="hasPerm('role.acl')"></el-button>
+          </router-link>
+          <router-link :to="'/acl/role/update/'+scope.row.id">
+            <el-button type="primary" size="mini" icon="el-icon-edit"  v-if="hasPerm('role.update')"></el-button>
+          </router-link>
+          <el-button type="danger" size="mini" icon="el-icon-delete" @click="removeDataById(scope.row.id)" v-if="hasPerm('role.remove')"></el-button>
+        </template>
+      </el-table-column>
+    </el-table>
+
+    <!-- 分页组件 -->
+    <el-pagination
+      :current-page="page"
+      :total="total"
+      :page-size="limit"
+      :page-sizes="[5, 10, 20, 30, 40, 50, 100]"
+      style="padding: 30px 0; text-align: center;"
+      layout="sizes, prev, pager, next, jumper, ->, total, slot"
+      @current-change="fetchData"
+      @size-change="changeSize"
+    />
+  </div>
+</template>
+
+<script>
+import roleApi from '@/api/acl/role'
+
+export default {
+  data() {
+    return {
+      listLoading: true, // 数据是否正在加载
+      list: null, // 讲师列表
+      total: 0, // 数据库中的总记录数
+      page: 1, // 默认页码
+      limit: 10, // 每页记录数
+      searchObj: {}, // 查询表单对象
+      multipleSelection: [] // 批量选择中选择的记录列表
+    }
+  },
+
+  // 生命周期函数：内存准备完毕，页面尚未渲染
+  created() {
+    console.log('list created......')
+    this.fetchData()
+  },
+
+  // 生命周期函数：内存准备完毕，页面渲染成功
+  mounted() {
+    console.log('list mounted......')
+  },
+
+  methods: {
+
+    // 当页码发生改变的时候
+    changeSize(size) {
+      console.log(size)
+      this.limit = size
+      this.fetchData(1)
+    },
+
+    addUser(){
+      this.$router.push({ path: '/acl/role/add' })
+    },
+
+    // 加载讲师列表数据
+    fetchData(page = 1) {
+      console.log('翻页。。。' + page)
+      // 异步获取远程数据（ajax）
+      this.page = page
+
+      roleApi.getPageList(this.page, this.limit, this.searchObj).then(
+        response => {
+          this.list = response.data.items
+          this.total = response.data.total
+
+          // 数据加载并绑定成功
+          this.listLoading = false
+        }
+      )
+    },
+
+    // 重置查询表单
+    resetData() {
+      console.log('重置查询表单')
+      this.searchObj = {}
+      this.fetchData()
+    },
+
+    // 根据id删除数据
+    removeDataById(id) {
+      // debugger
+      this.$confirm('此操作将永久删除该记录, 是否继续?', '提示', {
+        confirmButtonText: '确定',
+        cancelButtonText: '取消',
+        type: 'warning'
+      }).then(() => { // promise
+        // 点击确定，远程调用ajax
+        return roleApi.removeById(id)
+      }).then((response) => {
+        this.fetchData(this.page)
+        if (response.success) {
+          this.$message({
+            type: 'success',
+            message: '删除成功!'
+          })
+        }
+      }).catch(() => {
+        this.$message({
+          type: 'info',
+          message: '已取消删除'
+        })
+      })
+    },
+
+    // 当表格复选框选项发生变化的时候触发
+    handleSelectionChange(selection) {
+      console.log('handleSelectionChange......')
+      console.log(selection)
+      this.multipleSelection = selection
+    },
+
+    // 批量删除
+    removeRows() {
+      console.log('removeRows......')
+
+      if (this.multipleSelection.length === 0) {
+        this.$message({
+          type: 'warning',
+          message: '请选择要删除的记录!'
+        })
+        return
+      }
+
+      this.$confirm('此操作将永久删除该记录, 是否继续?', '提示', {
+        confirmButtonText: '确定',
+        cancelButtonText: '取消',
+        type: 'warning'
+      }).then(() => { // promise
+        // 点击确定，远程调用ajax
+        // 遍历selection，将id取出放入id列表
+        var idList = []
+        this.multipleSelection.forEach(item => {
+          idList.push(item.id)
+        // console.log(idList)
+        })
+        // 调用api
+        return roleApi.removeRows(idList)
+      }).then((response) => {
+        this.fetchData(this.page)
+        if (response.success) {
+          this.$message({
+            type: 'success',
+            message: '删除成功!'
+          })
+        }
+      }).catch(() => {
+        this.$message({
+          type: 'info',
+          message: '已取消删除'
+        })
+      })
+    },
+
+    // 执行搜索
+    // queryString：文本框中输入的值
+    // cb：一个函数
+    querySearch(queryString, cb) {
+      console.log(queryString)
+      console.log(cb)
+
+      // teacher.selectNameByKey(queryString).then(response => {
+      //   // 调用 callback 返回建议列表的数据
+      //   cb(response.data.items)
+      // })
+    }
+  }
+}
+</script>
+
Index: admin/src/views/acl/role/roleForm.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/acl/role/roleForm.vue	(date 1574926016000)
+++ admin/src/views/acl/role/roleForm.vue	(date 1574926016000)
@@ -0,0 +1,107 @@
+<template>
+  <div style="margin: 20px 20px">
+    <el-tree
+        :data="data"
+        show-checkbox
+        default-expand-all
+        node-key="id"
+        ref="tree"
+        highlight-current
+        :props="defaultProps">
+      </el-tree>
+    <el-button :disabled="saveBtnDisabled" type="primary" @click="save">保存</el-button>
+  </div>
+</template>
+<script>
+import menu from '@/api/acl/menu'
+
+export default {
+  data() {
+    return {
+      saveBtnDisabled:false,
+      data: [],
+      defaultProps: {
+        children: 'children',
+        label: 'name'
+      },
+      roleId:''
+
+    };
+  },
+  // 监听器
+  watch: {
+    $route(to, from) {
+      console.log('路由变化......')
+      console.log(to)
+      console.log(from)
+      this.init()
+    }
+  },
+
+  created () {
+    this.init()
+  },
+  methods: {
+
+    init(){
+      if (this.$route.params && this.$route.params.id) {
+          this.roleId = this.$route.params.id
+          this.fetchDataById(this.roleId)
+      } 
+    },
+    fetchDataById(roleId){
+        menu.toAssign(roleId).then(response => {
+            this.data = response.data.children
+            var jsonList = JSON.parse(JSON.stringify(this.data))
+            debugger;
+            var list = []
+            this.getJsonToList(list, jsonList[0]['children'])
+            console.log("最终集合")
+            console.log(list)
+            this.setCheckedKeys(list)
+        })
+    },
+    //把json数据转成string再转成对象，根据Key获取value数据
+    getJsonToList(list, jsonList){
+        //遍历这个集合对象，获取key的值
+        for(var i = 0; i < jsonList.length; i++){
+            if(jsonList[i]['select'] == true && jsonList[i]['level'] == 4){
+                list.push(jsonList[i]['id'])
+            }
+            if(jsonList[i]['children'] != null){ 
+              this.getJsonToList(list, jsonList[i]['children'])
+            } 
+        }
+        
+    },
+
+    getCheckedNodes() {
+      console.log(this.$refs.tree.getCheckedNodes());
+    },
+    getCheckedKeys() {
+      console.log(this.$refs.tree.getCheckedKeys());
+    },
+
+    setCheckedKeys(list) {
+      this.$refs.tree.setCheckedKeys(list);
+    },
+
+    save(){
+      this.saveBtnDisabled = true
+      var ids = this.$refs.tree.getCheckedKeys().join(",");
+      //vue elementUI tree树形控件获取父节点ID的实例
+      //node_modules\element-ui\lib\element-ui.common.js
+      //25348行修改源码
+      menu.doAssign(this.roleId, ids).then(response => {
+          if(response.success){
+              this.$message({
+                type:'success',
+                message:'保存成功'
+              })
+              this.$router.push({ path: '/acl/role/list' })
+            }
+      })
+    }
+  }
+};
+</script>
Index: admin/src/views/acl/menu/list.vue.back
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/acl/menu/list.vue.back	(date 1574926016000)
+++ admin/src/views/acl/menu/list.vue.back	(date 1574926016000)
@@ -0,0 +1,315 @@
+<template>
+  <div class="app-container">
+    <el-input v-model="filterText" placeholder="Filter keyword" style="margin-bottom:30px;" />
+
+    
+    <el-table
+    :data="menuList"
+    style="width: 100%;margin-bottom: 20px;"
+    row-key="id"
+    border
+    default-expand-all
+    :tree-props="{children: 'children', hasChildren: 'hasChildren'}">
+    <el-table-column
+      prop="name"
+      label="名称"
+      sortable
+      width="180">
+    </el-table-column>
+    <el-table-column
+      prop="path"
+      label="访问路径"
+      sortable
+      width="180">
+    </el-table-column>
+      <el-table-column
+        prop="component"
+        label="组件路径"
+        sortable
+        width="180">
+      </el-table-column>
+    <el-table-column
+      prop="permissionValue"
+      label="权限值">
+    </el-table-column>
+    <el-table-column 
+      label="操作">
+      <template slot-scope="scope">
+      <!-- v-if="node.level == 1 || node.level == 2" v-if="node.level == 3" v-if="node.level == 4"-->
+        <el-button
+              v-if="(scope.row.level == 1 || scope.row.level == 2) && hasPerm('permission.add')"
+              type="text"
+              size="mini"
+              @click="() => {dialogFormVisible = true, menu.pid = scope.row.id}">添加菜单</el-button>
+            <el-button
+              v-if="scope.row.level == 3 &&  hasPerm('permission.add')"
+              type="text"
+              size="mini"
+              @click="() => {dialogPermissionVisible = true, permission.pid = scope.row.id}">添加功能</el-button>
+              <el-button
+              v-if="scope.row.level == 4 &&  hasPerm('permission.update')"
+              type="text"
+              size="mini"
+              @click="() => updateFunction(scope.row)">修改功能</el-button>
+            <el-button
+              v-if="scope.row.level != 4 &&  hasPerm('permission.update')"
+              type="text"
+              size="mini"
+              @click="() => getById(scope.row)">修改</el-button>
+            <el-button
+              type="text"
+              size="mini"
+              @click="() => remove(scope.row)" v-if="hasPerm('permission.remove')">删除</el-button>
+        </template>
+    </el-table-column>
+  </el-table>
+
+    <el-dialog :visible.sync="dialogFormVisible" :title="dialogFormValue">
+        <el-form :model="menu" label-width="120px">
+            <el-form-item label="菜单名称">
+                <el-input v-model="menu.name"/>
+            </el-form-item>
+            <el-form-item label="访问路径">
+            <el-input v-model="menu.path"/>
+          </el-form-item>
+          <el-form-item label="组件路径">
+            <el-input v-model="menu.component"/>
+          </el-form-item>
+  
+        </el-form>
+        <div slot="footer" class="dialog-footer">
+            <el-button @click="restData()">取 消</el-button>
+            <el-button type="primary" @click="append()">确 定</el-button>
+        </div>
+    </el-dialog>
+    <!-- 添加功能的窗口 -->
+    <el-dialog :visible.sync="dialogPermissionVisible" title="添加功能">
+        <el-form :model="menu" label-width="120px">
+            <el-form-item label="功能名称">
+                <el-input v-model="permission.name"/>
+            </el-form-item>
+          <el-form-item label="访问路径">
+          <el-input v-model="permission.path"/>
+          </el-form-item>
+            <el-form-item label="组件路径">
+              <el-input v-model="permission.component"/>
+            </el-form-item>
+            <el-form-item label="功能权限值">
+                <el-input v-model="permission.permissionValue"/>
+            </el-form-item>
+  
+        </el-form>
+        <div slot="footer" class="dialog-footer">
+            <el-button @click="restData()">取 消</el-button>
+            <el-button type="primary" @click="appendPermission()">确 定</el-button>
+        </div>
+    </el-dialog>
+
+  </div>
+</template>
+
+<script>
+import menu from '@/api/acl/menu'
+
+const menuForm = {
+    name:'',
+    pid: 0,
+    path:'',
+    component:'',
+    type:'1'
+}
+const perForm = {
+  permissionValue:'',
+  type:'2',
+  name:'',
+  path:'',
+  component:'',
+  pid: 0
+}
+
+export default {
+
+  data() {
+    return {
+      filterText: '',
+      menuList: [],
+      defaultProps: {
+        children: 'children',
+        label: 'name'
+      },
+      dialogFormValue:'添加菜单',
+      dialogFormVisible: false,
+      dialogPermissionVisible:false,
+      menu: menuForm ,
+      permission: perForm
+    }
+  },
+  //监听上面文本框搜索
+  watch: {
+    filterText(val) {
+      this.$refs.menuTree.filter(val)
+    }
+  },
+
+  created() {
+    this.fetchNodeList()
+  },
+
+  methods: {
+    fetchNodeList() {
+      menu.getNestedTreeList().then(response => {
+        if (response.success === true) {
+          this.menuList = response.data.children
+          console.log(this.menuList)
+        }
+      })
+    },
+    filterNode(value, data) {
+      if (!value) return true
+      return data.title.toLowerCase().indexOf(value.toLowerCase()) !== -1
+    },
+    remove(data){
+        console.log(data)
+
+        this.$confirm('此操作将永久删除该记录, 是否继续?', '提示', {
+            confirmButtonText: '确定',
+            cancelButtonText: '取消',
+            type: 'warning'
+        }).then(() => {
+            return menu.removeById(data.id)
+        }).then(() => {
+             this.fetchNodeList()// 刷新列表
+            this.$message({
+                type: 'success',
+                message: '删除成功!'
+            })
+        }).catch((response) => { // 失败
+            if (response === 'cancel') {
+                this.$message({
+                    type: 'info',
+                    message: '已取消删除'
+                })
+            } else {
+                this.$message({
+                    type: 'error',
+                    message: '删除失败'
+                })
+            }
+        })
+
+    },
+    appendPermission(){
+      if(this.permission.id){
+          this.update(this.permission)
+      } else{
+        menu.saveLevelOne(this.permission).then(response => {
+            this.dialogPermissionVisible = false
+            this.$message({
+                type: 'success',
+                message: '添加功能成功'
+            })
+            //刷新页面
+            this.fetchNodeList()
+            this.menu = {...menuForm}
+            this.permission = {...perForm}
+        })
+      }
+    },
+    appendLevelOne(){
+        menu.saveLevelOne(this.menu)
+            .then(response => {
+                this.dialogFormVisible = false
+                this.$message({
+                    type: 'success',
+                    message: '添加一级菜单成功'
+                })
+                //刷新页面
+                this.fetchNodeList()
+                this.menu = {...menuForm}
+                this.permission = {...perForm}
+            })
+            .catch(response => {
+                //你们写：判断点击取消清空一下
+                this.dialogFormVisible = false
+                this.$message({
+                    type: 'error',
+                    message: '添加一级菜单失败'
+                })
+                this.menu = {...menuForm}
+                this.permission = {...perForm}
+            })
+    },
+    append(){
+      if(!this.menu.id){// 添加
+
+        if(this.menu.pid == 0 ){
+            this.appendLevelOne() // 一级分类的添加
+        } else{
+            this.appendLevelTwo() // 二级分类的添加
+        }
+      } else{ //修改
+        this.update(this.menu)
+      }
+        
+    },
+    update(obj){
+      
+      debugger
+      menu.update(obj).then(response => {
+        this.dialogFormVisible = false
+          this.$message({
+              type: 'success',
+              message: '修改成功'
+          })
+          //刷新页面
+          this.fetchNodeList()
+          this.restData()
+      })
+    },
+    appendLevelTwo(){
+        menu.saveLevelOne(this.menu)
+            .then(response => {
+                //1、把文本框关
+                this.dialogFormVisible = false
+                //2、提示成功
+                this.$message({
+                    type:'success',
+                    message:"添加二级分类成功"
+                })
+                //3、刷新页面
+                this.fetchNodeList()
+                //4、把menu清空
+                this.menu = {...menuForm}
+                this.permission = {...perForm}
+            })
+            .catch(response => {
+                //1、把文本框关
+                this.dialogFormVisible = false
+                //2、提示成功
+                this.$message({
+                    type:'error',
+                    message:"添加二级分类失败"
+                })                
+                //3、把menu清空
+                this.menu = {...menuForm}
+                this.permission = {...perForm}
+                
+            })
+    },
+    getById(data){
+      this.dialogFormVisible = true
+      this.menu = data
+    },
+    updateFunction(data){
+      this.dialogPermissionVisible = true
+      this.permission = data
+    },
+    restData(){
+      this.dialogPermissionVisible = false
+      this.dialogFormVisible = false
+      this.menu = {...menuForm}
+      this.permission = {...perForm}
+    }
+  }
+}
+</script>
Index: admin/src/views/acl/role/form.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/acl/role/form.vue	(date 1574926016000)
+++ admin/src/views/acl/role/form.vue	(date 1574926016000)
@@ -0,0 +1,114 @@
+<template>
+  <div class="app-container">
+    <el-form ref="role" :model="role" :rules="validateRules" label-width="120px">
+      <el-form-item label="角色名称" prop="roleName">
+        <el-input v-model="role.roleName"/>
+      </el-form-item>
+    <el-form-item>
+        <el-button :disabled="saveBtnDisabled" type="primary" @click="saveOrUpdate">保存</el-button>
+      </el-form-item>
+    </el-form>
+  </div>
+</template>
+
+<script>
+
+import roleApi from '@/api/acl/role'
+
+const defaultForm = {
+  roleName: ''
+}
+
+export default {
+  data() {
+    return {
+      role: defaultForm,
+      saveBtnDisabled: false, // 保存按钮是否禁用,
+      validateRules: {
+        roleName: [{ required: true, trigger: 'blur', message: '角色名必须输入' }]
+      }
+    }
+  },
+
+  // 监听器
+  watch: {
+    $route(to, from) {
+      console.log('路由变化......')
+      console.log(to)
+      console.log(from)
+      this.init()
+    }
+  },
+
+  // 生命周期方法（在路由切换，组件不变的情况下不会被调用）
+  created() {
+    console.log('form created ......')
+    this.init()
+  },
+
+  methods: {
+
+    // 表单初始化
+    init() {
+      debugger
+      if (this.$route.params && this.$route.params.id) {
+        const id = this.$route.params.id
+        this.fetchDataById(id)
+      } else {
+        // 对象拓展运算符：拷贝对象，而不是赋值对象的引用
+        this.role = { ...defaultForm }
+      }
+    },
+
+    saveOrUpdate() {
+      this.$refs.role.validate(valid => {
+        if (valid) {
+          this.saveBtnDisabled = true // 防止表单重复提交
+          if (!this.role.id) {
+            this.saveData()
+          } else {
+            this.updateData()
+          }
+        }
+      })
+    },
+
+    // 新增讲师
+    saveData() {
+      roleApi.save(this.role).then(response => {
+        // debugger
+        if (response.success) {
+          this.$message({
+            type: 'success',
+            message: response.message
+          })
+          this.$router.push({ path: '/acl/role/list' })
+        }
+      })
+    },
+
+    // 根据id更新记录
+    updateData() {
+      // teacher数据的获取
+      roleApi.updateById(this.role).then(response => {
+        if (response.success) {
+          this.$message({
+            type: 'success',
+            message: response.message
+          })
+          this.$router.push({ path: '/acl/role/list' })
+        }
+      })
+    },
+
+    // 根据id查询记录
+    fetchDataById(id) {
+      roleApi.getById(id).then(response => {
+        debugger
+        this.role = response.data.item
+      })
+    }
+
+  }
+}
+</script>
Index: admin/src/views/acl/menu/list.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/acl/menu/list.vue	(date 1574926016000)
+++ admin/src/views/acl/menu/list.vue	(date 1574926016000)
@@ -0,0 +1,335 @@
+<template>
+  <div class="app-container">
+    <el-input v-model="filterText" placeholder="Filter keyword" style="margin-bottom:30px;"/>
+
+
+    <el-table
+      :data="menuList"
+      style="width: 100%;margin-bottom: 20px;"
+      row-key="id"
+      border
+      default-expand-all
+      :tree-props="{children: 'children', hasChildren: 'hasChildren'}">
+      <el-table-column
+        prop="name"
+        label="名称"
+        sortable
+        width="180">
+      </el-table-column>
+      <el-table-column
+        prop="path"
+        label="访问路径"
+        sortable
+        width="180">
+      </el-table-column>
+      <el-table-column
+        prop="component"
+        label="组件路径"
+        sortable
+        width="180">
+      </el-table-column>
+      <el-table-column
+        prop="permissionValue"
+        label="权限值">
+      </el-table-column>
+      <el-table-column
+        label="操作">
+        <template slot-scope="scope">
+          <!-- v-if="node.level == 1 || node.level == 2" v-if="node.level == 3" v-if="node.level == 4"-->
+          <el-button
+            v-if="(scope.row.level == 1 || scope.row.level == 2) && hasPerm('permission.add')"
+            type="text"
+            size="mini"
+            @click="() => {dialogFormVisible = true, menu.pid = scope.row.id}">添加菜单
+          </el-button>
+          <el-button
+            v-if="scope.row.level == 3 &&  hasPerm('permission.add')"
+            type="text"
+            size="mini"
+            @click="() => {dialogPermissionVisible = true, permission.pid = scope.row.id}">添加功能
+          </el-button>
+          <el-button
+            v-if="scope.row.level == 4 &&  hasPerm('permission.update')"
+            type="text"
+            size="mini"
+            @click="() => updateFunction(scope.row)">修改功能
+          </el-button>
+          <el-button
+            v-if="scope.row.level != 4 &&  hasPerm('permission.update')"
+            type="text"
+            size="mini"
+            @click="() => getById(scope.row)">修改
+          </el-button>
+          <el-button
+            type="text"
+            size="mini"
+            @click="() => remove(scope.row)" v-if="hasPerm('permission.remove')">删除
+          </el-button>
+        </template>
+      </el-table-column>
+    </el-table>
+
+    <el-dialog :visible.sync="dialogFormVisible" :title="dialogFormValue">
+      <el-form ref="menu" :model="menu" :rules="menuValidateRules" label-width="120px">
+        <el-form-item label="菜单名称" prop="name">
+          <el-input v-model="menu.name"/>
+        </el-form-item>
+        <el-form-item label="访问路径" prop="path">
+          <el-input v-model="menu.path"/>
+        </el-form-item>
+        <el-form-item label="组件路径" prop="component">
+          <el-input v-model="menu.component"/>
+        </el-form-item>
+
+      </el-form>
+      <div slot="footer" class="dialog-footer">
+        <el-button @click="restData()">取 消</el-button>
+        <el-button type="primary" @click="append()">确 定</el-button>
+      </div>
+    </el-dialog>
+    <!-- 添加功能的窗口 -->
+    <el-dialog :visible.sync="dialogPermissionVisible" title="添加功能">
+      <el-form ref="permission" :model="permission" :rules="permissionValidateRules" label-width="120px">
+        <el-form-item label="功能名称" prop="name">
+          <el-input v-model="permission.name"/>
+        </el-form-item>
+        <el-form-item label="访问路径">
+          <el-input v-model="permission.path"/>
+        </el-form-item>
+        <el-form-item label="组件路径">
+          <el-input v-model="permission.component"/>
+        </el-form-item>
+        <el-form-item label="功能权限值" prop="permissionValue">
+          <el-input v-model="permission.permissionValue"/>
+        </el-form-item>
+
+      </el-form>
+      <div slot="footer" class="dialog-footer">
+        <el-button @click="restData()">取 消</el-button>
+        <el-button type="primary" @click="appendPermission()">确 定</el-button>
+      </div>
+    </el-dialog>
+
+  </div>
+</template>
+
+<script>
+import menu from '@/api/acl/menu'
+
+const menuForm = {
+  name: '',
+  pid: 0,
+  path: '',
+  component: '',
+  type: '1'
+}
+const perForm = {
+  permissionValue: '',
+  type: '2',
+  name: '',
+  path: '',
+  component: '',
+  pid: 0
+}
+
+export default {
+
+  data() {
+    return {
+      filterText: '',
+      menuList: [],
+      defaultProps: {
+        children: 'children',
+        label: 'name'
+      },
+      dialogFormValue: '添加菜单',
+      dialogFormVisible: false,
+      dialogPermissionVisible: false,
+      menu: menuForm,
+      permission: perForm,
+      menuValidateRules: {
+        name: [{required: true, trigger: 'blur', message: '菜单名必须输入'}],
+        path: [{required: true, trigger: 'blur', message: '菜单路径必须输入'}],
+        component: [{required: true, trigger: 'blur', message: '组件名称必须输入'}]
+      },
+      permissionValidateRules: {
+        name: [{required: true, trigger: 'blur', message: '功能名称必须输入'}],
+        permissionValue: [{required: true, trigger: 'blur', message: '功能权限值必须输入'}]
+      }
+    }
+  },
+  // 监听上面文本框搜索
+  watch: {
+    filterText(val) {
+      this.$refs.menuTree.filter(val)
+    }
+  },
+
+  created() {
+    this.fetchNodeList()
+  },
+
+  methods: {
+    fetchNodeList() {
+      menu.getNestedTreeList().then(response => {
+        if (response.success === true) {
+          this.menuList = response.data.children
+          console.log(this.menuList)
+        }
+      })
+    },
+    filterNode(value, data) {
+      if (!value) return true
+      return data.title.toLowerCase().indexOf(value.toLowerCase()) !== -1
+    },
+    remove(data) {
+      console.log(data)
+
+      this.$confirm('此操作将永久删除该记录, 是否继续?', '提示', {
+        confirmButtonText: '确定',
+        cancelButtonText: '取消',
+        type: 'warning'
+      }).then(() => {
+        return menu.removeById(data.id)
+      }).then(() => {
+        this.fetchNodeList()// 刷新列表
+        this.$message({
+          type: 'success',
+          message: '删除成功!'
+        })
+      }).catch((response) => { // 失败
+        if (response === 'cancel') {
+          this.$message({
+            type: 'info',
+            message: '已取消删除'
+          })
+        } else {
+          this.$message({
+            type: 'error',
+            message: '删除失败'
+          })
+        }
+      })
+    },
+    appendPermission() {
+      this.$refs.permission.validate(valid => {
+        if (valid) {
+          if (this.permission.id) {
+            this.update(this.permission)
+          } else {
+            menu.saveLevelOne(this.permission).then(response => {
+              this.dialogPermissionVisible = false
+              this.$message({
+                type: 'success',
+                message: '添加功能成功'
+              })
+              // 刷新页面
+              this.fetchNodeList()
+              this.menu = {...menuForm}
+              this.permission = {...perForm}
+            })
+          }
+        }
+      })
+    },
+    appendLevelOne() {
+      menu.saveLevelOne(this.menu)
+        .then(response => {
+          this.dialogFormVisible = false
+          this.$message({
+            type: 'success',
+            message: '添加一级菜单成功'
+          })
+          // 刷新页面
+          this.fetchNodeList()
+          this.menu = {...menuForm}
+          this.permission = {...perForm}
+        })
+        .catch(response => {
+          // 你们写：判断点击取消清空一下
+          this.dialogFormVisible = false
+          this.$message({
+            type: 'error',
+            message: '添加一级菜单失败'
+          })
+          this.menu = {...menuForm}
+          this.permission = {...perForm}
+        })
+    },
+
+    append() {
+      this.$refs.menu.validate(valid => {
+        if (valid) {
+          if (!this.menu.id) { // 添加
+            if (this.menu.pid == 0) {
+              this.appendLevelOne() // 一级分类的添加
+            } else {
+              this.appendLevelTwo() // 二级分类的添加
+            }
+          } else { // 修改
+            this.update(this.menu)
+          }
+        }
+      })
+    },
+
+    update(obj) {
+      debugger
+      menu.update(obj).then(response => {
+        this.dialogFormVisible = false
+        this.$message({
+          type: 'success',
+          message: '修改成功'
+        })
+        // 刷新页面
+        this.fetchNodeList()
+        this.restData()
+      })
+    },
+    appendLevelTwo() {
+      menu.saveLevelOne(this.menu)
+        .then(response => {
+          // 1、把文本框关
+          this.dialogFormVisible = false
+          // 2、提示成功
+          this.$message({
+            type: 'success',
+            message: "添加二级分类成功"
+          })
+          // 3、刷新页面
+          this.fetchNodeList()
+          // 4、把menu清空
+          this.menu = {...menuForm}
+          this.permission = {...perForm}
+        })
+        .catch(response => {
+          // 1、把文本框关
+          this.dialogFormVisible = false
+          // 2、提示成功
+          this.$message({
+            type: 'error',
+            message: "添加二级分类失败"
+          })
+          // 3、把menu清空
+          this.menu = {...menuForm}
+          this.permission = {...perForm}
+
+        })
+    },
+    getById(data) {
+      this.dialogFormVisible = true
+      this.menu = data
+    },
+    updateFunction(data) {
+      this.dialogPermissionVisible = true
+      this.permission = data
+    },
+    restData() {
+      this.dialogPermissionVisible = false
+      this.dialogFormVisible = false
+      this.menu = {...menuForm}
+      this.permission = {...perForm}
+    }
+  }
+}
+</script>
Index: admin/src/store/modules/app-bak.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/store/modules/app-bak.js	(date 1594686263821)
+++ admin/src/store/modules/app-bak.js	(date 1594686263821)
@@ -0,0 +1,43 @@
+import Cookies from 'js-cookie'
+
+const app = {
+  state: {
+    sidebar: {
+      opened: !+Cookies.get('sidebarStatus'),
+      withoutAnimation: false
+    },
+    device: 'desktop'
+  },
+  mutations: {
+    TOGGLE_SIDEBAR: state => {
+      if (state.sidebar.opened) {
+        Cookies.set('sidebarStatus', 1)
+      } else {
+        Cookies.set('sidebarStatus', 0)
+      }
+      state.sidebar.opened = !state.sidebar.opened
+      state.sidebar.withoutAnimation = false
+    },
+    CLOSE_SIDEBAR: (state, withoutAnimation) => {
+      Cookies.set('sidebarStatus', 1)
+      state.sidebar.opened = false
+      state.sidebar.withoutAnimation = withoutAnimation
+    },
+    TOGGLE_DEVICE: (state, device) => {
+      state.device = device
+    }
+  },
+  actions: {
+    ToggleSideBar: ({ commit }) => {
+      commit('TOGGLE_SIDEBAR')
+    },
+    CloseSideBar({ commit }, { withoutAnimation }) {
+      commit('CLOSE_SIDEBAR', withoutAnimation)
+    },
+    ToggleDevice({ commit }, device) {
+      commit('TOGGLE_DEVICE', device)
+    }
+  }
+}
+
+export default app
Index: admin/src/store/modules/user-bak.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/store/modules/user-bak.js	(date 1594686263821)
+++ admin/src/store/modules/user-bak.js	(date 1594686263821)
@@ -0,0 +1,87 @@
+import { login, logout, getInfo } from '@/api/login'
+import { getToken, setToken, removeToken } from '@/utils/auth'
+
+const user = {
+  state: {
+    token: getToken(),
+    name: '',
+    avatar: '',
+    roles: []
+  },
+
+  mutations: {
+    SET_TOKEN: (state, token) => {
+      state.token = token
+    },
+    SET_NAME: (state, name) => {
+      state.name = name
+    },
+    SET_AVATAR: (state, avatar) => {
+      state.avatar = avatar
+    },
+    SET_ROLES: (state, roles) => {
+      state.roles = roles
+    }
+  },
+
+  actions: {
+    // 登录
+    Login({ commit }, userInfo) {
+      const username = userInfo.username.trim()
+      return new Promise((resolve, reject) => {
+        login(username, userInfo.password).then(response => {
+          const data = response.data
+          setToken(data.token)
+          commit('SET_TOKEN', data.token)
+          resolve()
+        }).catch(error => {
+          reject(error)
+        })
+      })
+    },
+
+    // 获取用户信息
+    GetInfo({ commit, state }) {
+      return new Promise((resolve, reject) => {
+        getInfo(state.token).then(response => {
+          const data = response.data
+          if (data.roles && data.roles.length > 0) { // 验证返回的roles是否是一个非空数组
+            commit('SET_ROLES', data.roles)
+          } else {
+            reject('getInfo: roles must be a non-null array !')
+          }
+          commit('SET_NAME', data.name)
+          commit('SET_AVATAR', data.avatar)
+          resolve(response)
+        }).catch(error => {
+          reject(error)
+        })
+      })
+    },
+
+    // 登出
+    LogOut({ commit, state }) {
+      return new Promise((resolve, reject) => {
+        logout(state.token).then(() => {
+          commit('SET_TOKEN', '')
+          commit('SET_ROLES', [])
+          removeToken()
+          resolve()
+        }).catch(error => {
+          reject(error)
+        })
+      })
+    },
+
+    // 前端 登出
+    FedLogOut({ commit }) {
+      return new Promise(resolve => {
+        commit('SET_TOKEN', '')
+        removeToken()
+        resolve()
+      })
+    }
+  }
+}
+
+export default user
Index: admin/src/permission.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/permission.js	(revision 79792acc935129a65b7a3df733072f516bdb52d8)
+++ admin/src/permission.js	(date 1574926016000)
@@ -1,41 +1,69 @@
 import router from './router'
 import store from './store'
-import NProgress from 'nprogress' // Progress 进度条
-import 'nprogress/nprogress.css'// Progress 进度条样式
 import { Message } from 'element-ui'
-import { getToken } from '@/utils/auth' // 验权
+import NProgress from 'nprogress' // progress bar
+import 'nprogress/nprogress.css' // progress bar style
+import { getToken } from '@/utils/auth' // get token from cookie
+
+NProgress.configure({ showSpinner: false }) // NProgress Configuration
 
-const whiteList = ['/login'] // 不重定向白名单
-router.beforeEach((to, from, next) => {
+const whiteList = ['/login', '/auth-redirect'] // no redirect whitelist
+
+router.beforeEach(async(to, from, next) => {
+  // start progress bar
   NProgress.start()
-  if (getToken()) {
+
+  // determine whether the user has logged in
+  const hasToken = getToken()
+
+  if (hasToken) {
     if (to.path === '/login') {
+      // if is logged in, redirect to the home page
       next({ path: '/' })
-      NProgress.done() // if current page is dashboard will not trigger	afterEach hook, so manually handle it
+      NProgress.done()
     } else {
-      if (store.getters.roles.length === 0) {
-        store.dispatch('GetInfo').then(res => { // 拉取用户信息
-          next()
-        }).catch((err) => {
-          store.dispatch('FedLogOut').then(() => {
-            Message.error(err || 'Verification failed, please login again')
-            next({ path: '/' })
-          })
-        })
+      // determine whether the user has obtained his permission roles through getInfo
+      const hasRoles = store.getters.roles && store.getters.roles.length > 0
+      if (hasRoles) {
+        next()
       } else {
-        next()
+        try {
+          // get user info
+          // note: roles must be a object array! such as: ['admin'] or ,['developer','editor']
+          const { roles } = await store.dispatch('GetInfo')
+
+          // generate accessible routes map based on roles
+          const accessRoutes = await store.dispatch('permission/generateRoutes', roles)
+
+          // dynamically add accessible routes
+
+          router.addRoutes(accessRoutes)
+
+          next({ ...to, replace: true })
+        } catch (error) {
+          // remove token and go to login page to re-login
+          await store.dispatch('FedLogOut')
+          Message.error(error || 'Has Error')
+          next(`/login?redirect=${to.path}`)
+          NProgress.done()
+        }
       }
     }
   } else {
+    /* has no token*/
+
     if (whiteList.indexOf(to.path) !== -1) {
+      // in the free login whitelist, go directly
       next()
     } else {
-      next(`/login?redirect=${to.path}`) // 否则全部重定向到登录页
+      // other pages that do not have permission to access are redirected to the login page.
+      next(`/login?redirect=${to.path}`)
       NProgress.done()
     }
   }
 })
 
 router.afterEach(() => {
-  NProgress.done() // 结束Progress
+  // finish progress bar
+  NProgress.done()
 })
Index: admin/src/store/modules/index.js.back
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/store/modules/index.js.back	(date 1574926016000)
+++ admin/src/store/modules/index.js.back	(date 1574926016000)
@@ -0,0 +1,17 @@
+import Vue from 'vue'
+import Vuex from 'vuex'
+import app from './modules/app'
+import user from './modules/user'
+import getters from './getters'
+
+Vue.use(Vuex)
+
+const store = new Vuex.Store({
+  modules: {
+    app,
+    user
+  },
+  getters
+})
+
+export default store
Index: admin/src/permission-bak.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/permission-bak.js	(date 1594686263811)
+++ admin/src/permission-bak.js	(date 1594686263811)
@@ -0,0 +1,41 @@
+import router from './router'
+import store from './store'
+import NProgress from 'nprogress' // Progress 进度条
+import 'nprogress/nprogress.css'// Progress 进度条样式
+import { Message } from 'element-ui'
+import { getToken } from '@/utils/auth' // 验权
+
+const whiteList = ['/login'] // 不重定向白名单
+router.beforeEach((to, from, next) => {
+  NProgress.start()
+  if (getToken()) {
+    if (to.path === '/login') {
+      next({ path: '/' })
+      NProgress.done() // if current page is dashboard will not trigger	afterEach hook, so manually handle it
+    } else {
+      if (store.getters.roles.length === 0) {
+        store.dispatch('GetInfo').then(res => { // 拉取用户信息
+          next()
+        }).catch((err) => {
+          store.dispatch('FedLogOut').then(() => {
+            Message.error(err || 'Verification failed, please login again')
+            next({ path: '/' })
+          })
+        })
+      } else {
+        next()
+      }
+    }
+  } else {
+    if (whiteList.indexOf(to.path) !== -1) {
+      next()
+    } else {
+      next(`/login?redirect=${to.path}`) // 否则全部重定向到登录页
+      NProgress.done()
+    }
+  }
+})
+
+router.afterEach(() => {
+  NProgress.done() // 结束Progress
+})
Index: admin/src/store/modules/permission.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/store/modules/permission.js	(date 1574926016000)
+++ admin/src/store/modules/permission.js	(date 1574926016000)
@@ -0,0 +1,62 @@
+import { constantRoutes } from '@/router'
+import { getMenu } from '@/api/login'
+import Layout from '@/views/layout/Layout'
+
+function filterAsyncRouter(asyncRouterMap) { // 遍历后台传来的路由字符串，转换为组件对象
+  try {
+    const accessedRouters = asyncRouterMap.filter(route => {
+      if (route.component) {
+        if (route.component === 'Layout') { // Layout组件特殊处理
+          route.component = Layout
+        } else {
+          const component = route.component
+          route.component = resolve => {
+            require(['@/views' + component + '.vue'], resolve)
+          }
+        }
+      }
+      if (route.children && route.children.length) {
+        route.children = filterAsyncRouter(route.children)
+      }
+      return true
+    })
+    return accessedRouters
+  } catch (e) {
+    console.log(e)
+  }
+}
+
+const state = {
+  routes: [],
+  addRoutes: []
+}
+
+const mutations = {
+  SET_ROUTES: (state, routes) => {
+    state.addRoutes = routes
+    state.routes = constantRoutes.concat(routes)
+  }
+}
+
+const actions = {
+  async generateRoutes({ commit }, roles) {
+    // 取后台路由
+
+    const asyncRouter = await getMenu()
+
+    return new Promise(resolve => {
+      const tmp = asyncRouter.data.permissionList
+      const accessedRoutes = filterAsyncRouter(tmp)
+
+      commit('SET_ROUTES', accessedRoutes)
+      resolve(accessedRoutes)
+    })
+  }
+}
+
+export default {
+  namespaced: true,
+  state,
+  mutations,
+  actions
+}
Index: admin/src/router/index-bak.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/router/index-bak.js	(date 1595950642657)
+++ admin/src/router/index-bak.js	(date 1595950642657)
@@ -0,0 +1,265 @@
+import Vue from 'vue'
+import Router from 'vue-router'
+
+// in development-env not use lazy-loading, because lazy-loading too many pages will cause webpack hot update too slow. so only in production use lazy-loading;
+// detail: https://panjiachen.github.io/vue-element-admin-site/#/lazy-loading
+
+Vue.use(Router)
+
+/* Layout */
+import Layout from '../views/layout/Layout'
+
+/**
+* hidden: true                   if `hidden:true` will not show in the sidebar(default is false)
+* alwaysShow: true               if set true, will always show the root menu, whatever its child routes length
+*                                if not set alwaysShow, only more than one route under the children
+*                                it will becomes nested mode, otherwise not show the root menu
+* redirect: noredirect           if `redirect:noredirect` will no redirect in the breadcrumb
+* name:'router-name'             the name is used by <keep-alive> (must set!!!)
+* meta : {
+    title: 'title'               the name show in submenu and breadcrumb (recommend set)
+    icon: 'svg-name'             the icon show in the sidebar,
+  }
+**/
+export const constantRouterMap = [
+  { path: '/login', component: () => import('@/views/login/index'), hidden: true },
+  { path: '/404', component: () => import('@/views/404'), hidden: true },
+
+  {
+    path: '/',
+    component: Layout,
+    redirect: '/dashboard',
+    name: 'Dashboard',
+    hidden: true,
+    children: [{
+      path: 'dashboard',
+      component: () => import('@/views/dashboard/index')
+    }]
+  },
+
+  {
+    path: '/teacher',
+    component: Layout,
+    redirect: '/teacher/table',
+    name: '讲师管理',
+    meta: { title: '讲师管理', icon: 'example' },
+    children: [
+      {
+        path: 'teacherList',
+        name: '讲师列表',
+        component: () => import('@/views/edu/teacher/list'),
+        meta: { title: '讲师列表', icon: 'table' }
+      },
+      {
+        path: 'addTeacher',
+        name: '添加讲师',
+        component: () => import('@/views/edu/teacher/add'),
+        meta: { title: '添加讲师', icon: 'tree' }
+      },
+      {
+        path: 'edit/:id', // :id 相当于占位符，里面要传参数
+        name: 'EduTeacherEdit',
+        component: () => import('@/views/edu/teacher/add'),
+        meta: { title: '编辑讲师', noCache: true },
+        hidden: true
+      }
+    ]
+  },
+
+  {
+    path: '/subject',
+    component: Layout,
+    redirect: '/subject/list',
+    name: '课程分类管理',
+    meta: { title: '课程分类管理', icon: 'example' },
+    children: [
+      {
+        path: 'list',
+        name: '课程分类列表',
+        component: () => import('@/views/edu/subject/list'),
+        meta: { title: '课程分类列表', icon: 'table' }
+      },
+      {
+        path: 'save',
+        name: '添加课程分类',
+        component: () => import('@/views/edu/subject/save'),
+        meta: { title: '添加课程分类', icon: 'tree' }
+      }
+    ]
+  },
+
+  {
+    path: '/course',
+    component: Layout,
+    redirect: '/course/list',
+    name: '课程管理',
+    meta: { title: '课程管理', icon: 'example' },
+    children: [
+      {
+        path: 'list',
+        name: '课程列表',
+        component: () => import('@/views/edu/course/list'),
+        meta: { title: '课程列表', icon: 'table' }
+      },
+      {
+        path: 'info',
+        name: '添加课程',
+        component: () => import('@/views/edu/course/info'),
+        meta: { title: '添加课程', icon: 'tree' }
+      },
+      {
+        path: 'info/:id',
+        name: 'EduCourseInfoEdit',
+        component: () => import('@/views/edu/course/info'),
+        meta: { title: '编辑课程基本信息', noCache: true },
+        hidden: true
+      },
+      {
+        path: 'chapter/:id',
+        name: 'EduCourseChapterEdit',
+        component: () => import('@/views/edu/course/chapter'),
+        meta: { title: '编辑课程大纲', noCache: true },
+        hidden: true
+      },
+      {
+        path: 'publish/:id',
+        name: 'EduCoursePublishEdit',
+        component: () => import('@/views/edu/course/publish'),
+        meta: { title: '发布课程', noCache: true },
+        hidden: true
+      }
+    ]
+  },
+  {
+    path: '/sta',
+    component: Layout,
+    redirect: '/sta/create',
+    name: '统计分析',
+    meta: { title: '统计分析', icon: 'example' },
+    children: [
+      {
+        path: 'create',
+        name: '生成数据',
+        component: () => import('@/views/sta/create'),
+        meta: { title: '生成数据', icon: 'table' }
+      },
+      {
+        path: 'show',
+        name: '图表显示',
+        component: () => import('@/views/sta/show'),
+        meta: { title: '图表显示', icon: 'tree' }
+      }
+    ]
+  },
+  {
+    path: '/example',
+    component: Layout,
+    redirect: '/example/table',
+    name: 'Example',
+    meta: { title: 'Example', icon: 'example' },
+    children: [
+      {
+        path: 'table',
+        name: 'Table',
+        component: () => import('@/views/table/index'),
+        meta: { title: 'Table', icon: 'table' }
+      },
+      {
+        path: 'tree',
+        name: 'Tree',
+        component: () => import('@/views/tree/index'),
+        meta: { title: 'Tree', icon: 'tree' }
+      }
+    ]
+  },
+
+  {
+    path: '/form',
+    component: Layout,
+    children: [
+      {
+        path: 'index',
+        name: 'Form',
+        component: () => import('@/views/form/index'),
+        meta: { title: 'Form', icon: 'form' }
+      }
+    ]
+  },
+
+  {
+    path: '/nested',
+    component: Layout,
+    redirect: '/nested/menu1',
+    name: 'Nested',
+    meta: {
+      title: 'Nested',
+      icon: 'nested'
+    },
+    children: [
+      {
+        path: 'menu1',
+        component: () => import('@/views/nested/menu1/index'), // Parent router-view
+        name: 'Menu1',
+        meta: { title: 'Menu1' },
+        children: [
+          {
+            path: 'menu1-1',
+            component: () => import('@/views/nested/menu1/menu1-1'),
+            name: 'Menu1-1',
+            meta: { title: 'Menu1-1' }
+          },
+          {
+            path: 'menu1-2',
+            component: () => import('@/views/nested/menu1/menu1-2'),
+            name: 'Menu1-2',
+            meta: { title: 'Menu1-2' },
+            children: [
+              {
+                path: 'menu1-2-1',
+                component: () => import('@/views/nested/menu1/menu1-2/menu1-2-1'),
+                name: 'Menu1-2-1',
+                meta: { title: 'Menu1-2-1' }
+              },
+              {
+                path: 'menu1-2-2',
+                component: () => import('@/views/nested/menu1/menu1-2/menu1-2-2'),
+                name: 'Menu1-2-2',
+                meta: { title: 'Menu1-2-2' }
+              }
+            ]
+          },
+          {
+            path: 'menu1-3',
+            component: () => import('@/views/nested/menu1/menu1-3'),
+            name: 'Menu1-3',
+            meta: { title: 'Menu1-3' }
+          }
+        ]
+      },
+      {
+        path: 'menu2',
+        component: () => import('@/views/nested/menu2/index'),
+        meta: { title: 'menu2' }
+      }
+    ]
+  },
+
+  {
+    path: 'external-link',
+    component: Layout,
+    children: [
+      {
+        path: 'https://panjiachen.github.io/vue-element-admin-site/#/',
+        meta: { title: 'External Link', icon: 'link' }
+      }
+    ]
+  },
+
+  { path: '*', redirect: '/404', hidden: true }
+]
+
+export default new Router({
+  // mode: 'history', //后端支持可开
+  scrollBehavior: () => ({ y: 0 }),
+  routes: constantRouterMap
+})
Index: admin/src/main-bak.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/main-bak.js	(date 1594686263811)
+++ admin/src/main-bak.js	(date 1594686263811)
@@ -0,0 +1,27 @@
+import Vue from 'vue'
+
+import 'normalize.css/normalize.css' // A modern alternative to CSS resets
+
+import ElementUI from 'element-ui'
+import 'element-ui/lib/theme-chalk/index.css'
+import locale from 'element-ui/lib/locale/lang/zh-CN' // lang i18n
+
+import '@/styles/index.scss' // global css
+
+import App from './App'
+import router from './router'
+import store from './store'
+
+import '@/icons' // icon
+import '@/permission' // permission control
+
+Vue.use(ElementUI, { locale })
+
+Vue.config.productionTip = false
+
+new Vue({
+  el: '#app',
+  router,
+  store,
+  render: h => h(App)
+})
Index: admin/src/api/acl/role.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/api/acl/role.js	(date 1574926016000)
+++ admin/src/api/acl/role.js	(date 1574926016000)
@@ -0,0 +1,56 @@
+import request from '@/utils/request'
+
+const api_name = '/admin/acl/role'
+
+export default {
+
+    getPageList(page, limit, searchObj) {
+        return request({
+            url: `${api_name}/${page}/${limit}`,
+            method: 'get',
+            params: searchObj // url查询字符串或表单键值对
+        })
+    },
+    getById(id) {
+        return request({
+          url: `${api_name}/get/${id}`,
+          method: 'get'
+        })
+      },
+    
+      save(role) {
+        return request({
+          url: `${api_name}/save`,
+          method: 'post',
+          data: role
+        })
+      },
+    
+      updateById(role) {
+        return request({
+          url: `${api_name}/update`,
+          method: 'put',
+          data: role
+        })
+      },
+      getAssign(roleId){
+        return request({
+          url: `${api_name}/toAssign/${roleId}`,
+          method: 'get'
+        })
+      },
+      removeById(id){
+        return request({
+          url: `${api_name}/remove/${id}`,
+          method: 'delete'
+        })
+      },
+      removeRows(idList){
+        return request({
+          url: `${api_name}/batchRemove`,
+          method: 'delete',
+          data:idList
+        })
+      }
+      
+}
Index: admin/src/main.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/main.js	(revision 79792acc935129a65b7a3df733072f516bdb52d8)
+++ admin/src/main.js	(date 1574926016000)
@@ -14,10 +14,12 @@
 
 import '@/icons' // icon
 import '@/permission' // permission control
+import { hasBtnPermission } from './utils/permission' // button permission
 
 Vue.use(ElementUI, { locale })
 
 Vue.config.productionTip = false
+Vue.prototype.hasPerm = hasBtnPermission
 
 new Vue({
   el: '#app',
Index: admin/src/api/acl/user.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/api/acl/user.js	(date 1574926016000)
+++ admin/src/api/acl/user.js	(date 1574926016000)
@@ -0,0 +1,62 @@
+import request from '@/utils/request'
+
+const api_name = '/admin/acl/user'
+
+export default {
+
+    getPageList(page, limit, searchObj) {
+        return request({
+            url: `${api_name}/${page}/${limit}`,
+            method: 'get',
+            params: searchObj // url查询字符串或表单键值对
+        })
+    },
+    getById(id) {
+        return request({
+          url: `${api_name}/get/${id}`,
+          method: 'get'
+        })
+      },
+    
+      save(user) {
+        return request({
+          url: `${api_name}/save`,
+          method: 'post',
+          data: user
+        })
+      },
+    
+      updateById(user) {
+        return request({
+          url: `${api_name}/update`,
+          method: 'put',
+          data: user
+        })
+      },
+      getAssign(userId){
+        return request({
+          url: `${api_name}/toAssign/${userId}`,
+          method: 'get'
+        })
+      },
+      saveAssign(userId, roleId){
+        return request({
+          url: `${api_name}/doAssign`,
+          method: 'post',
+          params:{userId, roleId}
+        })
+      },
+      removeById(id){
+        return request({
+          url: `${api_name}/remove/${id}`,
+          method: 'delete'
+        })
+      },
+      removeRows(idList){
+        return request({
+          url: `${api_name}/batchRemove`,
+          method: 'delete',
+          data:idList
+        })
+      }
+}
Index: admin/src/api/acl/menu.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/api/acl/menu.js	(date 1574926016000)
+++ admin/src/api/acl/menu.js	(date 1574926016000)
@@ -0,0 +1,45 @@
+import request from '@/utils/request'
+
+const api_name = '/admin/acl/permission'
+
+export default {
+  getNestedTreeList() {
+    return request({
+      url: `${api_name}`,
+      method: 'get'
+    })
+  },
+  removeById(id) {
+    return request({
+      url: `${api_name}/remove/${id}`,
+      method: "delete"
+    })
+  },
+  saveLevelOne(menu) {
+    return request({
+      url: `${api_name}/save`,
+      method: "post",
+      data: menu
+    })
+  },
+  update(menu) {
+    return request({
+      url: `${api_name}/update`,
+      method: "put",
+      data: menu
+    })
+  },
+  toAssign(roleId) {
+    return request({
+      url: `${api_name}/toAssign/${roleId}`,
+      method: 'get'
+    })
+  },
+  doAssign(roleId, permissionId) {
+    return request({
+      url: `${api_name}/doAssign`,
+      method: "post",
+      params: {roleId, permissionId}
+    })
+  }
+}
Index: admin/src/api/loginbak.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/api/loginbak.js	(date 1594686263801)
+++ admin/src/api/loginbak.js	(date 1594686263801)
@@ -0,0 +1,27 @@
+import request from '@/utils/request'
+
+export function login(username, password) {
+  return request({
+    url: '/edu/service/user/login',
+    method: 'post',
+    data: {
+      username,
+      password
+    }
+  })
+}
+
+export function getInfo(token) {
+  return request({
+    url: '/edu/service/user/info',
+    method: 'get',
+    params: { token }
+  })
+}
+
+export function logout() {
+  return request({
+    url: '/user/logout',
+    method: 'post'
+  })
+}
Index: admin/src/api/login.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/api/login.js	(revision 79792acc935129a65b7a3df733072f516bdb52d8)
+++ admin/src/api/login.js	(date 1584366018411)
@@ -1,8 +1,10 @@
 import request from '@/utils/request'
 
+// 登录
 export function login(username, password) {
+ // debugger
   return request({
-    url: '/edu/service/user/login',
+    url: '/admin/acl/login',
     method: 'post',
     data: {
       username,
@@ -11,17 +13,28 @@
   })
 }
 
+// 获取用户信息
 export function getInfo(token) {
   return request({
-    url: '/edu/service/user/info',
+    url: '/admin/acl/index/info',
     method: 'get',
     params: { token }
   })
 }
 
+// 登出
 export function logout() {
+  //debugger
   return request({
-    url: '/user/logout',
+    url: '/admin/acl/index/logout',
     method: 'post'
   })
 }
+
+// 获取菜单权限数据
+export function getMenu() {
+  return request({
+    url: '/admin/acl/index/menu',
+    method: 'get'
+  })
+}
Index: admin/src/router/index.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/router/index.js	(revision 79792acc935129a65b7a3df733072f516bdb52d8)
+++ admin/src/router/index.js	(date 1596382600237)
@@ -21,22 +21,28 @@
     icon: 'svg-name'             the icon show in the sidebar,
   }
 **/
-export const constantRouterMap = [
+export const constantRoutes = [
   { path: '/login', component: () => import('@/views/login/index'), hidden: true },
   { path: '/404', component: () => import('@/views/404'), hidden: true },
 
+  // 首页
   {
     path: '/',
     component: Layout,
     redirect: '/dashboard',
     name: 'Dashboard',
-    hidden: true,
     children: [{
       path: 'dashboard',
-      component: () => import('@/views/dashboard/index')
+      component: () => import('@/views/dashboard/index'),
+      meta: { title: '谷粒学院后台首页', icon: 'dashboard' }
     }]
-  },
+  }]
+/**
+ * 动态路由
+ */
+export const asyncRoutes = [
 
+  // 讲师管理
   {
     path: '/teacher',
     component: Layout,
@@ -45,21 +51,21 @@
     meta: { title: '讲师管理', icon: 'example' },
     children: [
       {
-        path: 'teacherList',
+        path: 'table',
         name: '讲师列表',
         component: () => import('@/views/edu/teacher/list'),
         meta: { title: '讲师列表', icon: 'table' }
       },
       {
-        path: 'addTeacher',
+        path: 'save',
         name: '添加讲师',
-        component: () => import('@/views/edu/teacher/add'),
+        component: () => import('@/views/edu/teacher/save'),
         meta: { title: '添加讲师', icon: 'tree' }
       },
       {
-        path: 'edit/:id', // :id 相当于占位符，里面要传参数
+        path: 'edit/:id',
         name: 'EduTeacherEdit',
-        component: () => import('@/views/edu/teacher/add'),
+        component: () => import('@/views/edu/teacher/save'),
         meta: { title: '编辑讲师', noCache: true },
         hidden: true
       }
@@ -130,6 +136,7 @@
       }
     ]
   },
+
   {
     path: '/sta',
     component: Layout,
@@ -151,115 +158,93 @@
       }
     ]
   },
+
   {
-    path: '/example',
+    path: '/acl',
     component: Layout,
-    redirect: '/example/table',
-    name: 'Example',
-    meta: { title: 'Example', icon: 'example' },
+    redirect: '/acl/user/list',
+    name: '权限管理',
+    meta: { title: '权限管理', icon: 'chart' },
     children: [
       {
-        path: 'table',
-        name: 'Table',
-        component: () => import('@/views/table/index'),
-        meta: { title: 'Table', icon: 'table' }
+        path: 'user/list',
+        name: '用户管理',
+        component: () => import('@/views/acl/user/list'),
+        meta: { title: '用户管理' }
       },
       {
-        path: 'tree',
-        name: 'Tree',
-        component: () => import('@/views/tree/index'),
-        meta: { title: 'Tree', icon: 'tree' }
-      }
-    ]
-  },
-
-  {
-    path: '/form',
-    component: Layout,
-    children: [
+        path: 'role/list',
+        name: '角色管理',
+        component: () => import('@/views/acl/role/list'),
+        meta: { title: '角色管理' }
+      },
       {
-        path: 'index',
-        name: 'Form',
-        component: () => import('@/views/form/index'),
-        meta: { title: 'Form', icon: 'form' }
-      }
-    ]
-  },
-
-  {
-    path: '/nested',
-    component: Layout,
-    redirect: '/nested/menu1',
-    name: 'Nested',
-    meta: {
-      title: 'Nested',
-      icon: 'nested'
-    },
-    children: [
+        path: 'role/form',
+        name: '角色添加',
+        component: () => import('@/views/acl/role/form'),
+        meta: { title: '角色添加' },
+        hidden: true
+      },
+      {
+        path: 'role/update/:id',
+        name: '角色修改',
+        component: () => import('@/views/acl/role/form'),
+        meta: { title: '角色修改' },
+        hidden: true
+      },
       {
-        path: 'menu1',
-        component: () => import('@/views/nested/menu1/index'), // Parent router-view
-        name: 'Menu1',
-        meta: { title: 'Menu1' },
-        children: [
-          {
-            path: 'menu1-1',
-            component: () => import('@/views/nested/menu1/menu1-1'),
-            name: 'Menu1-1',
-            meta: { title: 'Menu1-1' }
-          },
-          {
-            path: 'menu1-2',
-            component: () => import('@/views/nested/menu1/menu1-2'),
-            name: 'Menu1-2',
-            meta: { title: 'Menu1-2' },
-            children: [
-              {
-                path: 'menu1-2-1',
-                component: () => import('@/views/nested/menu1/menu1-2/menu1-2-1'),
-                name: 'Menu1-2-1',
-                meta: { title: 'Menu1-2-1' }
-              },
-              {
-                path: 'menu1-2-2',
-                component: () => import('@/views/nested/menu1/menu1-2/menu1-2-2'),
-                name: 'Menu1-2-2',
-                meta: { title: 'Menu1-2-2' }
-              }
-            ]
-          },
-          {
-            path: 'menu1-3',
-            component: () => import('@/views/nested/menu1/menu1-3'),
-            name: 'Menu1-3',
-            meta: { title: 'Menu1-3' }
-          }
-        ]
+        path: 'role/distribution/:id',
+        name: '角色权限',
+        component: () => import('@/views/acl/role/roleForm'),
+        meta: { title: '角色权限' },
+        hidden: true
+      },
+      {
+        path: 'menu/list',
+        name: '菜单管理',
+        component: () => import('@/views/acl/menu/list'),
+        meta: { title: '菜单管理' }
+      },
+      {
+        path: 'user/add',
+        name: '用户添加',
+        component: () => import('@/views/acl/user/form'),
+        meta: { title: '用户添加' },
+        hidden: true
+      },
+      {
+        path: 'user/update/:id',
+        name: '用户修改',
+        component: () => import('@/views/acl/user/form'),
+        meta: { title: '用户修改' },
+        hidden: true
       },
       {
-        path: 'menu2',
-        component: () => import('@/views/nested/menu2/index'),
-        meta: { title: 'menu2' }
+        path: 'user/role/:id',
+        name: '用户角色',
+        component: () => import('@/views/acl/user/roleForm'),
+        meta: { title: '用户角色' },
+        hidden: true
       }
-    ]
-  },
 
-  {
-    path: 'external-link',
-    component: Layout,
-    children: [
-      {
-        path: 'https://panjiachen.github.io/vue-element-admin-site/#/',
-        meta: { title: 'External Link', icon: 'link' }
-      }
     ]
   },
 
   { path: '*', redirect: '/404', hidden: true }
 ]
 
-export default new Router({
-  // mode: 'history', //后端支持可开
+const createRouter = () => new Router({
+  // mode: 'history', // require service support
   scrollBehavior: () => ({ y: 0 }),
-  routes: constantRouterMap
+  routes: constantRoutes
 })
+
+const router = createRouter()
+
+// export default new Router({
+//   // mode: 'history', //后端支持可开
+//   scrollBehavior: () => ({ y: 0 }),
+//   routes: constantRouterMap
+// })
+
+export default router
Index: admin/package.json
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/package.json	(revision 79792acc935129a65b7a3df733072f516bdb52d8)
+++ admin/package.json	(date 1596376808790)
@@ -15,13 +15,15 @@
   },
   "dependencies": {
     "axios": "0.18.0",
+    "echarts": "^4.1.0",
     "element-ui": "2.4.6",
     "js-cookie": "2.2.0",
     "normalize.css": "7.0.0",
     "nprogress": "0.2.0",
     "vue": "2.5.17",
     "vue-router": "3.0.1",
-    "vuex": "3.0.1"
+    "vuex": "3.0.1",
+    "vuex-persistedstate": "^3.0.1"
   },
   "devDependencies": {
     "autoprefixer": "8.5.0",
Index: admin/src/views/dashboard/index.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/dashboard/index.vue	(revision 79792acc935129a65b7a3df733072f516bdb52d8)
+++ admin/src/views/dashboard/index.vue	(date 1574926016000)
@@ -1,7 +1,7 @@
 <template>
   <div class="dashboard-container">
-    <div class="dashboard-text">name:{{ name }}</div>
-    <div class="dashboard-text">roles:<span v-for="role in roles" :key="role">{{ role }}</span></div>
+    <div class="dashboard-text">用户名:{{ name }}</div>
+    <div class="dashboard-text">用户角色:<span v-for="role in roles" :key="role">{{ role }}</span></div>
   </div>
 </template>
 
Index: admin/src/views/layout/components/Sidebar/index.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/layout/components/Sidebar/index.vue	(revision 79792acc935129a65b7a3df733072f516bdb52d8)
+++ admin/src/views/layout/components/Sidebar/index.vue	(date 1574926016000)
@@ -22,11 +22,9 @@
   components: { SidebarItem },
   computed: {
     ...mapGetters([
+      'routes',
       'sidebar'
     ]),
-    routes() {
-      return this.$router.options.routes
-    },
     isCollapse() {
       return !this.sidebar.opened
     }
Index: admin/src/views/layout/components/Navbar.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/layout/components/Navbar.vue	(revision 79792acc935129a65b7a3df733072f516bdb52d8)
+++ admin/src/views/layout/components/Navbar.vue	(date 1574926016000)
@@ -10,11 +10,11 @@
       <el-dropdown-menu slot="dropdown" class="user-dropdown">
         <router-link class="inlineBlock" to="/">
           <el-dropdown-item>
-            首页
+            主页
           </el-dropdown-item>
         </router-link>
         <el-dropdown-item divided>
-          <span style="display:block;" @click="logout">退出</span>
+          <span style="display:block;" @click="logout">登出</span>
         </el-dropdown-item>
       </el-dropdown-menu>
     </el-dropdown>
Index: admin/src/views/layout/Layout.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/layout/Layout.vue	(revision 79792acc935129a65b7a3df733072f516bdb52d8)
+++ admin/src/views/layout/Layout.vue	(date 1574926016000)
@@ -15,7 +15,7 @@
 
 export default {
   name: 'Layout',
-  components: { //
+  components: {
     Navbar,
     Sidebar,
     AppMain
Index: admin/src/views/login/index.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- admin/src/views/login/index.vue	(revision 79792acc935129a65b7a3df733072f516bdb52d8)
+++ admin/src/views/login/index.vue	(date 1576204391556)
@@ -1,7 +1,7 @@
 <template>
   <div class="login-container">
     <el-form ref="loginForm" :model="loginForm" :rules="loginRules" class="login-form" auto-complete="on" label-position="left">
-      <h3 class="title">格桑学院后台管理系统</h3>
+      <h3 class="title">谷粒学院后台管理系统</h3>
       <el-form-item prop="username">
         <span class="svg-container">
           <svg-icon icon-class="user" />
@@ -24,13 +24,13 @@
         </span>
       </el-form-item>
       <el-form-item>
-        <el-button :loading="loading" type="primary" style="width:100%;" @click.native.prevent="handleLogin">
+        <el-button :loading="loading" type="primary" style="width:100%;" @click="handleLogin">
           登录
         </el-button>
       </el-form-item>
       <div class="tips">
         <span style="margin-right:20px;">username: admin</span>
-        <span> password: admin</span>
+        <span> password: 111111</span>
       </div>
     </el-form>
   </div>
@@ -50,16 +50,16 @@
       }
     }
     const validatePass = (rule, value, callback) => {
-      if (value.length < 5) {
-        callback(new Error('密码不能小于5位'))
+      if (value.length < 6) {
+        callback(new Error('密码不能小于6位'))
       } else {
         callback()
       }
     }
     return {
       loginForm: {
-        username: 'admin',
-        password: 'admin'
+        username: '',
+        password: ''
       },
       loginRules: {
         username: [{ required: true, trigger: 'blur', validator: validateUsername }],
@@ -89,6 +89,7 @@
     handleLogin() {
       this.$refs.loginForm.validate(valid => {
         if (valid) {
+         // debugger
           this.loading = true
           this.$store.dispatch('Login', this.loginForm).then(() => {
             this.loading = false
diff --git admin/src/utils/index.js admin/src/utils/index.js
diff --git admin/src/store/modules/app.js admin/src/store/modules/app.js
diff --git admin/src/views/layout/components/Sidebar/Link.vue admin/src/views/layout/components/Sidebar/Link.vue
diff --git admin/src/views/layout/components/Sidebar/SidebarItem.vue admin/src/views/layout/components/Sidebar/SidebarItem.vue
diff --git admin/src/views/layout/components/Sidebar/Item.vue admin/src/views/layout/components/Sidebar/Item.vue
diff --git admin/src/views/layout/components/AppMain.vue admin/src/views/layout/components/AppMain.vue
diff --git admin/src/views/layout/components/index.js admin/src/views/layout/components/index.js
diff --git admin/src/views/layout/mixin/ResizeHandler.js admin/src/views/layout/mixin/ResizeHandler.js
